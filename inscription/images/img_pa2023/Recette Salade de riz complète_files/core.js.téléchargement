!function(){var n,e=null;try{parent.test,e=parent}catch(n){e=window}"performance"in e==0&&(e.performance={}),"now"in e.performance==0&&(n=Date.now(),e.performance.timing&&e.performance.timing.navigationStart&&(n=e.performance.timing.navigationStart),e.performance.now=function(){return Date.now()-n}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(n,e){e=e||window;for(var o=0;o<this.length;o++)n.call(e,this[o],o,this)})}(),function(){"use strict";{var l,s,a,r,f,d,e,p,m,v,y,g,w,b,_,h,n,I,In=null,Rn=null,kn=null,xn=null,Sn=!1,Tn=0,An=[],En=[],Dn=(document.referrer,conf.user.device.type&&("mobile phone"===conf.user.device.type.toLowerCase()||"mobile device"===conf.user.device.type.toLowerCase())),R="ontouchstart"in document.documentElement,k=0==conf.product.id,Cn=1==conf.product.id,wn=(conf.product.id,conf.product.id,4==conf.product.id),On=5==conf.product.id,Pn=6==conf.product.id,Nn=!1,Vn=!1,Un=!1,x="viously_debug=1",Ln=!1,S=1,T=2,A=3,E=5,D=6,C="autoplay_muted",O="autoplay_audible",P="clicktoplay",bn={n:function(n){bn.n.history=bn.n.history||[],bn.n.history.push(n),conf.history=bn.n.history,window.console,window.location.href&&-1<window.location.href.indexOf(x)&&(Ln=!0,console.log(n))},e:R?"touchstart":"click",o:function(n,e,o,t){var c,i;!window.location.href||(i=(c=hn.t(e||conf.admin.current_index)).events[n])&&(t=t||"",e="ts="+Math.round(100*bn.c())/100+"&sid="+conf.id_session_one_hour+"&svid="+c.id_session_video+"&spgid="+conf.id_session_page+"&udbn="+(conf.user.device.browser&&conf.user.device.browser.name?conf.user.device.browser.name:"")+"&udbvm="+(conf.user.device.browser&&conf.user.device.browser.version?conf.user.device.browser.version.major:"")+"&udbvn="+(conf.user.device.browser&&conf.user.device.browser.version?conf.user.device.browser.version.minor:"")+"&udon="+(conf.user.device.os&&conf.user.device.os.name?conf.user.device.os.name:"")+"&udsh="+document.documentElement.clientHeight+"&udsw="+document.documentElement.clientWidth+"&udso="+(document.documentElement.clientWidth>=document.documentElement.clientHeight?"landscape":"portrait")+"&udt="+(conf.user.device.type||"")+"&ugcy="+(conf.user.geoip.country?conf.user.geoip.country.code:"")+"&ugcn="+(conf.user.geoip.country?conf.user.geoip.country.name:"")+"&ul="+navigator.language+"&pasi="+conf.page.audience_source.id+"&pasn="+conf.page.audience_source.name+"&pdi="+conf.page.domain.id+"&pdn="+conf.page.domain.name+"&pgs="+(conf.page.grapeshot&&conf.page.grapeshot.gv_safe?"true":"")+"&pge="+(conf.page.grapeshot&&conf.page.grapeshot.gs_error?"true":"")+"&pgsg="+(conf.page.grapeshot&&conf.page.grapeshot.gs_channels?conf.page.grapeshot.gs_channels:"")+"&pgsgt="+(conf.page.grapeshot&&conf.page.grapeshot.gs_terms?encodeURIComponent(conf.page.grapeshot.gs_terms):"")+"&pgcsg="+(conf.page.grapeshot&&conf.page.grapeshot.vc_channels?conf.page.grapeshot.vc_channels:"")+"&pgsy="+(conf.page.grapeshot&&conf.page.grapeshot.safety?conf.page.grapeshot.safety:"unknown")+"&pru="+encodeURIComponent(conf.page.referrer.url)+"&prh="+encodeURIComponent(conf.page.referrer.hostname)+"&pta="+(conf.page.tcf.addtlConsent?"true":"false")+"&ptna="+conf.page.tcf.nbAddtlConsent+"&ptci="+(conf.page.tcf.cmp?conf.page.tcf.cmp.id:"")+"&ptcv="+(conf.page.tcf.cmp?conf.page.tcf.cmp.version:"")+"&ptfa="+(conf.page.tcf.gdprApplies?"true":"false")+"&ptts="+(conf.page.tcf.tcString?"true":"false")+"&ptv="+conf.page.tcf.nbVendors+"&pu="+encodeURIComponent(conf.page.url)+"&pua="+conf.page.usp.applies+"&puu="+conf.page.usp.uspString+"&ti="+conf.template.id+"&tv="+conf.template.version+"&tt="+conf.type+"&talmpv="+conf.template.advertising.linear.max_preroll_viously+"&ta="+bn.i()+"&tpt="+conf.template.play_type+"&tm="+conf.template.mute+"&plid="+(conf.playlist.id||"")+"&plit="+(conf.playlist.type||"")+"&plix="+hn.a(e)+"&plw="+hn.l.r.offsetWidth+"&plh="+hn.l.r.offsetHeight+"&plci="+c.category.id+"&plcn="+c.category.name+"&plchi="+c.channel.id+"&plchn="+c.channel.name+"&plcrn="+c.creator.name+"&plcru="+c.creator.uid+"&plcd="+new Date(c.date.replace(" ","T")).getTime()+"&plcdu="+c.duration+"&plcl="+c.language+"&plpd="+new Date(c.parent.date.replace(" ","T")).getTime()+"&plpv="+c.parent.vid+"&plcr="+c.ratio+"&plst="+c.starttime+"&plet="+c.endtime+"&plv="+c.vid+"&pid="+conf.product.id+"&pn="+conf.product.name+"&duid="+conf.diffuser.uid+"&dun="+conf.diffuser.name+"&ct="+bn.u()+"&ptbtop="+hn.s()+"&ptbatf="+hn.f()+"&lph="+("https:"===location.protocol)+"&sia="+!!conf.sdk_async+"&pnpv="+conf.page.nb_players+"&pix="+conf.page.player_index+"&ptct="+conf.page.tcf.consentType+"&ptact="+conf.page.tcf.additionalConsentType+"&uib="+conf.user.is_bot+"&ptcus="+conf.page.tcf.cmpuistate+t,!navigator.sendBeacon||"ios"===(conf.user.device.os&&conf.user.device.os.name&&conf.user.device.os.name.toLowerCase())&&bn.d()<13?(new Image).src=conf.admin.event_url+i+"?"+e:navigator.sendBeacon(conf.admin.event_url+i+"?"+e),!0===o&&(c.events[n]=!1))},p:function(n){var e,o=[];for(e in n)n.hasOwnProperty(e)&&o.push(e+"="+encodeURIComponent(n[e]));return o.join("&")},m:function(n,e,o){bn.n("Push analytics : ["+n+", "+e+", "+(o=o||"")+"]");var t=window.ga||window.parent.ga;t&&t("send","event",n,e,o)},v:function(n,e,o){conf.admin.currencies_rate[n.currency]&&(n.pf=Number(parseFloat(Number(n.pf)/Number(conf.admin.currencies_rate[n.currency])).toFixed(o)),n.currency=e)},y:function(n){n.pf=Number(n.pf*(1-n.fee))},d:function(){var n=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);return!!n&&parseInt(n[1],10)},g:function(n,e){n.classList?n.classList.add(e):n.className+=" "+e},b:function(n,e){n.classList?n.classList.remove(e):n.className=n.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")},_:function(n,e){if(n.classList)n.classList.toggle(e);else{for(var o=n.className.split(" "),t=-1,c=o.length;c--;)o[c]===e&&(t=c);0<=t?o.splice(t,1):o.push(e),n.className=o.join(" ")}},I:function(n,e,o){var t="timeupdate"===e?{passive:!0}:!1;window.addEventListener?n.addEventListener(e,o,t):(n["e"+e+o]=o,n[e+o]=function(){n["e"+e+o](window.event)},n.attachEvent("on"+e,n[e+o]))},R:function(n,e,o){window.removeEventListener?n.removeEventListener(e,o,!1):(n.detachEvent("on"+e,n[e+o]),n[e+o]=null)},k:function(n,e){return n.split(".").reduce(function(n,e){return n?n[e]:null},e||self)},x:function(n){return decodeURIComponent((n+"").replace(/\+/g,"%20"))},S:function(n){var e,o,t,c,i="",a="",r="",l=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=u.indexOf(n.charAt(l++))<<2|(t=u.indexOf(n.charAt(l++)))>>4,o=(15&t)<<4|(c=u.indexOf(n.charAt(l++)))>>2,a=(3&c)<<6|(r=u.indexOf(n.charAt(l++))),i+=String.fromCharCode(e),64!==c&&(i+=String.fromCharCode(o)),64!==r&&(i+=String.fromCharCode(a)),t=c=r=e=o=a="",l<n.length;);return unescape(i)},T:function(n){return hn.l.r.offsetWidth<=320?n.thumbnails.w240:hn.l.r.offsetWidth<=620?n.thumbnails.w320:hn.l.r.offsetWidth<=960?n.thumbnails.w620:n.thumbnails.w960},A:function(n,e,o,t,c,i){var a;n?window.XMLHttpRequest?((a=new window.XMLHttpRequest).onreadystatechange=function(){var n;4===this.readyState&&(200<=(n=this.status)&&n<300||304===n?c(this.responseText,"XHR success"):c(null,"XHR Fail"))},a.ontimeout=function(){c(null,"XHR Timeout")},a.open(e,n,!0),a.timeout=t,"withCredentials"in a&&(a.withCredentials=o),a.responseType="text","POST"===e&&i?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.send(i)):(a.setRequestHeader("Content-Type","text/plain"),a.send())):c(null,"XHR not supported"):c(null,"URL not specified")},D:function(n){return encodeURIComponent(n&&n.childNodes.length&&n.childNodes[0].nodeValue||"")},C:function(n,e,o,t){var c=document.createElement("script");c.src=e,t&&(c.async=t),c.readyState?c.onreadystatechange=function(){"loaded"===c.readyState||"complete"===c.readyState?(bn.n("Script "+e+" "+c.readyState),c.onreadystatechange=null,o&&o()):bn.n("Script "+e+" "+c.readyState)}:(c.onload=function(){bn.n("Script "+e+" loaded"),c.onload=null,o&&o()},c.onerror=function(){bn.n("Script "+e+" error"),c.onload=null,o&&o()}),n.insertBefore(c,n.firstChild)},O:function(n,e,o){var t=document.createElement("style");t.type="text/css",e&&(t.id=e),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n)),(o=o||document.body).appendChild(t)},P:function(n){n=Number(n);var e=Math.floor(n/3600),o=Math.floor(n%3600/60),n=Math.floor(n%3600%60);return(e=0!==e?("0"+e).slice(-2)+":":"")+("0"+o).slice(-2)+":"+("0"+n).slice(-2)},N:function(n,e){"function"==typeof n.fastSeek?n.fastSeek(e):n.currentTime=e},V:function(n,e,o){for(var t=0;t<n.length;t++)if(n[t][e]==o)return t},U:function(n,e,o){n.splice(o,0,n.splice(e,1)[0])},L:function(o,t,c,i,a){var r,l,u,s=null,f=0,d=function(){f=new Date,s=null,u=o.apply(r,l)};return function(){var n=new Date,e=t-(n-(f=f||c?f:n));return r=a||this,l=arguments,e<=0?(clearTimeout(s),s=null,f=n,u=o.apply(r,l)):!s&&i&&(s=setTimeout(d,e)),u}},M:function(n){for(var e=n.length;0!==e;){var o=Math.floor(Math.random()*e),t=n[--e];n[e]=n[o],n[o]=t}},B:function(n,e,o){e=e||window;var t,c,n=n.getBoundingClientRect();return o?(t=n.width)*(c=n.height)!=0&&(n.left<0&&(t-=n.left),n.right>(e.innerWidth||e.document.documentElement.clientWidth)&&(t-=n.right-(e.innerWidth||e.document.documentElement.clientWidth)),n.top<0&&(c-=n.top),n.bottom>(e.innerHeight||e.document.documentElement.clientHeight)&&(c-=n.bottom-(e.innerHeight||e.document.documentElement.clientHeight)),o<(t=t<0?0:t)*(c=c<0?0:c)/(n.width*n.height)):0<=Math.floor(n.top)&&0<=Math.floor(n.left)&&Math.floor(n.bottom)<=(e.innerHeight||e.document.documentElement.clientHeight)&&Math.floor(n.right)<=(e.innerWidth||e.document.documentElement.clientWidth)},u:function(){var n=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return n&&n.effectiveType?n.effectiveType:"unknown"},c:function(){var e=0;try{e=(wn?parent.performance:performance).now()}catch(n){e=0}return e},z:function(n,e){var o={},t=hn.t(e||conf.admin.current_index),c=[];o.vpaid_abtest=kn;for(var i=0;i<t.vasts.length;i++)c[i]=t.vasts[i].id_vast_type;if(o.vsl_rpm_prio=c.join(","),n){if(n.key_values&&n.key_values.vsl_algo_rpm_floor&&(o.vsl_algo_rpm_floor=n.key_values.vsl_algo_rpm_floor),n.aer&&(o.vsl_api_estimated_rpm=n.aer),n.api_debug)for(var a in n.api_debug)o["api_floor_"+a]=n.api_debug[a];n.request_timestamp&&n.response_timestamp&&(o.request_latency=n.response_timestamp-n.request_timestamp),-1<n.url.indexOf("pubads.g.doubleclick.net")&&(o.google_vast=!0)}return conf.advertising.aec&&(o.api_error_code=conf.advertising.aec),o},G:function(n,e,o,t){var c=1e3*conf.admin.ads_request_timeout;return 0===hn.a(n)&&0===e&&!1===o&&(c=1e3*conf.admin.first_ad_request_timeout),c=t&&-1==t.id_ssp?1e3*conf.admin.booster_ad_request_timeout:c},q:function(n){(new Image).src=n},F:function(n){for(var e in n)bn.q(n[e])},i:function(){return"autoplay"===conf.template.play_type},J:function(n){conf.template.play_type=n?"autoplay":"clicktoplay"},H:function(){return"scrolltoplay"===conf.template.play_type},j:function(){return bn.i()||bn.H()}},_n={Y:null,o:function(n){var e;wn&&((e=document.createEvent("Event")).initEvent(n,!0,!0),_n.Y.dispatchEvent(e))},X:function(){wn&&viously.fn.sticky.countdown()},W:function(){wn&&viously.fn.sticky.allow()},Q:function(){wn&&viously.fn.sticky.disallow()},K:function(){wn&&(hn.Z(!0),"advertising"!==hn.$()&&hn.l.r.pause(),hn.en.nn(!1),bn.o(55,null,!0))},tn:function(n){wn&&(_n.Y=parent.document.getElementById("_"+n),_n.o("playerSetup"),viously.fn.stop=_n.K)}},Mn={cn:function(){try{return localStorage.setItem("test","1"),localStorage.removeItem("test"),!0}catch(n){return!1}}(),in:function(){try{return sessionStorage.setItem("test","1"),sessionStorage.removeItem("test"),!0}catch(n){return!1}}(),an:function(n,e){Mn.cn&&localStorage.setItem(n,e)},rn:function(n){return Mn.cn?localStorage.getItem(n):null},ln:function(n){Mn.cn&&localStorage.removeItem(n)},un:function(n,e){Mn.in&&sessionStorage.setItem(n,e)},sn:function(n){return Mn.in?sessionStorage.getItem(n):null},dn:function(n){Mn.in&&sessionStorage.removeItem(n)}},N=function e(n){var _="IMA : ",a=document.getElementById("ad-container"),n=n||{},h=null,i=0,S=null,T=null,A=null,E=null,D=null,I={pn:!1,mn:!1,Y:document.getElementById("ad"),vn:null,yn:0,gn:null,wn:!1,bn:conf.admin.current_index,_n:!1,hn:0,In:null,Rn:!1,kn:-1,xn:!1},C=!1,l={},r=!1,u=null,s="request-timeout",O=[],c=function(){null!=xn?(bn.n(_+"AdDisplayContainer defined"),!1===Sn&&((Sn=!0)===hn.Sn.$()&&hn.l.r.load(),xn.initialize(),bn.n(_+"AdDisplayContainer init"))):bn.n(_+"AdDisplayContainer undefined")},f=function(){function n(n,e){window.apstag.Tn.push([n,e])}!0===Un||window.apstag||(window.apstag={init:function(){n("i",arguments)},fetchBids:function(){n("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},Tn:[]},bn.C(document.body,"//c.amazon-adsystem.com/aax2/apstag.js",function(){Un=!0,bn.n("APS : library loaded"),void 0!==window.apstag&&window.apstag.debug&&window.apstag.init({pubID:"362e6c6d-8da2-4e42-b166-454ccc1976f0",videoAdServer:"DFP",schain:{complete:1,ver:"1.0",nodes:[{asi:"viously.com",sid:conf.admin.ad_seller_id,hp:1}]}}),bn.n("APS : initialized")},!0))},P=function(){h.resize(hn.l.r.offsetWidth,hn.l.r.offsetHeight,google.ima.ViewMode.NORMAL)},N=function(e){var n=hn.t(e),o=n.vid;if(bn.n(_+"Init "+o+" "+e),null==In&&(In=n.vasts&&n.vasts.length&&n.vasts[0].key_values&&n.vasts[0].key_values.vsl_prio_version?n.vasts[0].key_values.vsl_prio_version:"manual"),n.original_vasts||(n.original_vasts=JSON.parse(JSON.stringify(n.vasts))),void 0===n.synchronous_vasts&&K(e),n.backfill_buckets||(n.backfill_buckets=[]),n.bidder_timestamp)bn.c()-n.bidder_timestamp>1e3*conf.admin.expire_timeout?(bn.n(_+"Bids expired"),delete n.bidder_timestamp,N(e)):(bn.n(_+"Bids already done"),e==conf.admin.current_index?null==I.gn?L(e):!0!==I.pn||I.mn||Y():bn.n(_+"can't launch competion : a_video_index "+e+" (vid: "+o+") doesn't match current a_video_index "+conf.admin.current_index+" (vid: "+hn.An(conf.admin.current_index)+")"));else if(!1===conf.template.advertising.linear.viously&&(n.vasts=[]),n.vasts&&n.vasts.length)if(0!=conf.page.tcf.googleAllowed&&f(),!1===Nn)bn.C(document.body,conf.admin.ima_sdk_url,function(){if(Nn=!0,conf.advertising.user_sync.third_party_images)for(var n in conf.advertising.user_sync.third_party_images)bn.q(conf.advertising.user_sync.third_party_images[n]);if(conf.advertising.user_sync.third_party_scripts)for(var n in conf.advertising.user_sync.third_party_scripts)bn.C(document.body,conf.advertising.user_sync.third_party_scripts[n],null,!0);N(e)});else if("undefined"!=typeof google&&"ima"in google){n.bidder_timestamp=bn.c(),0==In.indexOf("api")&&G(hn.t(e).vasts);o=bn.z();if(gn(e)&&(o.dar_called=!0),bn.o(189,e,!0,"&dbpl="+encodeURIComponent(JSON.stringify(o))),0!=I.hn||n.vasts_string||bn.o(202,e,!1,"&aaf=linear&adix="+parseInt(I.hn)),null===xn&&(google.ima.settings.setLocale(conf.user.language),kn=Rn=Math.random()<.95?(google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE),"insecure"):(google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),"enabled"),bn.n(_+"VPAID MODE is "+Rn),google.ima.settings.setNumRedirects(conf.admin.ima_num_redirects),xn=new google.ima.AdDisplayContainer(a,hn.l.r,a)),J(n.vasts),conf.advertising.linear.primary&&!n.vasts_string)n.original_vasts.push(conf.advertising.linear.primary),b(e);else{var t=[];if(0==conf.page.tcf.googleAllowed)for(var c=n.vasts.length;c--;)-1<(i=n.vasts[c]).url.indexOf("pubads.g.doubleclick.net")&&(bn.n(_+k(i)+" -> GOOGLE not allowed"),n.vasts.splice(c,1));if(wn)for(c=n.vasts.length;c--;){var i=n.vasts[c];"optimized"===conf.type||"top"==conf.template.sdk.initial_position?39==i.id_vast_type&&(bn.n(_+k(i)+" -> CUSTOM not allowed"),n.vasts.splice(c,1)):16==i.id_vast_type&&(bn.n(_+k(i)+" -> OPTIMIZED not allowed"),n.vasts.splice(c,1))}if(n.vasts.length&&1==conf.template.mute)for(c=n.vasts.length;c--;)0==(i=n.vasts[c]).can_mute&&(bn.n(_+k(i)+" cannot play muted"),n.vasts.splice(c,1));if(H(n.vasts),j(n.vasts),!n.vasts.length)return delete n.bidder_timestamp,N(e);for(c=0;c<n.vasts.length;c++)(i=n.vasts[c]).outstream=!1,i.passback_viously?(n.backfill_buckets[i.position]||(n.backfill_buckets[i.position]=[]),n.backfill_buckets[i.position].push(i),n.vasts.splice(c,1),c--):F(i.id_vast_type)&&n.first_reserve_vast_called?(bn.n(_+"Vast "+k(i)+" goes to vasts reserve list"),n.synchronous_vasts.push(i),n.vasts.splice(c,1),c--):(pn(e,i,r?0:parseInt(I.hn)),i.aps?y(e,i.vast_index):i.prebid?t.push(i.prebid_bidder):d(e,i.vast_index),F(i.id_vast_type)&&(n.first_reserve_vast_called=!0));t.length&&p(e,t)}}else e==conf.admin.current_index?(_n.o("adBlocked"),X(_+"ad blocked",!0)):hn.en.En(conf.admin.current_index),bn.o(174,e,!0,"&aaf=linear");else bn.o(175,e,!0,"&aaf=linear"),e==conf.admin.current_index?(_n.o("noVasts"),X(_+"no vasts",!0)):hn.en.En(conf.admin.current_index)},o=function(n){var e=hn.t(n);bn.n(_+"Reset "+e.vid+" "+n);try{h&&h.destroy();for(var o=0;o<e.vasts.length;o++){var t=e.vasts[o];!0===t.ad&&!0===t.played&&t.adsLoader&&t.adsLoader.contentComplete()}}catch(n){bn.n(_+"Cannot destroy ima")}I.hn=0,C=!1,Q(!(r=!(l={})))},p=function(c,i){if(!0===Vn&&window.vslypbjs){for(var n=[],e=[],o=[],t=[],a=hn.t(c),r={video:{},page:{}},l=0,u=null;l<i.length;l++)1==(u=a.vasts[bn.V(a.vasts,"id_vast_type",i[l].params.idVastType)]).s2s&&e.push(i[l].bidder),(1==u.outstream?t:o).push(i[l]);if(conf.advertising.linear.pred){if(conf.advertising.linear.pred.vtr&&conf.advertising.linear.pred.vtr.dur)for(var s in r.video.vtr={},conf.advertising.linear.pred.vtr.dur)r.video.vtr[s]=parseFloat(conf.advertising.linear.pred.vtr.dur[s]);conf.advertising.linear.pred.mrc&&(r.video.mrc=parseFloat(conf.advertising.linear.pred.mrc))}conf.page.grapeshot&&1==conf.page.grapeshot.gv_safe&&(r.page.brandsafety=!0),o.length&&n.push({code:"video",mediaTypes:{video:{pos:hn.f()?1:3,context:"instream",placement:1,playerSize:[[640,480]],api:[1,2],mimes:["video/mp4","application/javascript"],protocols:[1,2,3,4,5,6,7,8],playbackmethod:[hn.Dn()],minduration:0,maxduration:900,w:hn.l.r.offsetWidth,h:hn.l.r.offsetHeight,startdelay:0,linearity:1,skip:1,skipmin:34,skipafter:34,delivery:1,playbackend:3}},ortb2Imp:{ext:{gpid:"/V2_Open/V2_Open_"+conf.diffuser.uid+"/V2_Open_"+conf.diffuser.uid+"_"+conf.product.id,data:{pbadslot:"V2_Open/V2_Open_"+conf.diffuser.uid+"/V2_Open_"+conf.diffuser.uid+"_"+conf.product.id,bricks:r}}},video:{divId:"vsly-player-container"},user:{language:(navigator.language||"en").slice(0,2).toUpperCase()},bids:o}),t.length&&n.push({code:"ad-outstream",mediaTypes:{video:{pos:hn.f()?1:3,context:"outstream",placement:3,playerSize:[[640,480]],api:[1,2],mimes:["video/mp4","application/javascript"],protocols:[1,2,3,4,5,6,7,8],playbackmethod:[hn.Dn()],minduration:0,maxduration:900,w:hn.l.r.offsetWidth,h:hn.l.r.offsetHeight,startdelay:0,skip:1,skipmin:34,skipafter:34,delivery:1,playbackend:3,renderer:{url:"https://cdn.adnxs.com/renderer/video/ANOutstreamVideo.js",render:function(n){bn.n("PREBID : renderer "+JSON.stringify(n))}}}},ortb2Imp:{ext:{gpid:"/V2_Open/V2_Open_"+conf.diffuser.uid+"/V2_Open_"+conf.diffuser.uid+"_"+conf.product.id,data:{pbadslot:"V2_Open/V2_Open_"+conf.diffuser.uid+"/V2_Open_"+conf.diffuser.uid+"_"+conf.product.id,bricks:r}}},video:{divId:"ad-outstream"},user:{language:(navigator.language||"en").slice(0,2).toUpperCase()},bids:t}),window.vslypbjs.removeAdUnit(),window.vslypbjs.addAdUnits(n);var n={debug:Ln,bidderTimeout:bn.G(c,I.hn,I.mn),consentManagement:{gdpr:{timeout:10,actionTimeout:10,cmpApi:"static",defaultGdprScope:conf.page.tcf.gdprApplies,allowAuctionWithoutConsent:!0,consentData:{getTCData:{gdprApplies:conf.page.tcf.gdprApplies,tcString:conf.page.tcf.tcString,addtlConsent:conf.page.tcf.addtlConsent,purpose:conf.page.tcf.purpose,vendor:conf.page.tcf.vendor}}},usp:{timeout:10,cmpApi:"static",consentData:{getUSPData:{uspString:conf.page.usp.uspString}}}},cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},ortb2:{site:{name:conf.diffuser.name,domain:conf.page.domain.name,page:conf.page.url,ref:conf.page.referrer.url}},pageUrl:conf.page.url,userSync:{syncEnabled:!0,aliasSyncEnabled:!0,iframeEnabled:!0,filterSettings:{all:{bidders:"*",filter:"include"}},syncsPerBidder:0,enableOverride:!0,syncDelay:3e3,auctionDelay:50,userIds:[{name:"quantcastId"},{name:"teadsId",params:{pubId:25484}},{name:"uid2"},{name:"criteo"},{name:"id5Id",params:{partner:246},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:28800}}]},pubcid:{enable:!0},currency:{adServerCurrency:"EUR",rates:{USD:{EUR:1/Number(conf.admin.currencies_rate.USD)}}},floors:{enforcement:{enforceJS:!0,enforcePBS:!0},data:{currency:"EUR",modelVersion:"Global floor",schema:{fields:["adUnitCode"]},values:{video:1,"ad-outstream":.5}}}},f=(e.length&&(n.s2sConfig={accountId:"fcd2457b-f514-4411-8d63-0efce5bfc1c9",bidders:["smartadserver","ix","pubmatic","rubicon","openx","sharethrough","grid","adyoulike","improvedigital","triplelift","unruly","adot","oftmedia","adkernel","medianet","amx","nobid","rubicon-outstream","openx-outstream","improvedigital-outstream","grid-outstream","oftmedia-outstream"],allowUnknownBidderCodes:!1,enabled:!0,timeout:2e3,adapter:"prebidServer",endpoint:{p1Consent:"https://pbsj.bricks-co.com/openrtb2/auction",noP1Consent:"https://pbsj.bricks-co.com/openrtb2/auction"},syncEndpoint:{p1Consent:"https://pbsj.bricks-co.com/cookie_sync",noP1Consent:"https://pbsj.bricks-co.com/cookie_sync"},coopSync:!0,extPrebid:{aliases:{oftmedia:"appnexus","rubicon-outstream":"rubicon","openx-outstream":"openx","improvedigital-outstream":"improvedigital","grid-outstream":"grid","oftmedia-outstream":"appnexus"},cache:{vastxml:{returnCreative:!1}},bidadjustmentfactors:{improvedigital:.7,"improvedigital-outstream":.7}}}),Cn||(n.schain={validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"viously.com",sid:conf.admin.ad_seller_id,hp:1}]}}),window.vslypbjs.bidderSettings={standard:{storageAllowed:!0}},window.vslypbjs.setBidderConfig({bidders:["grid"],config:{localStorageWriteAllowed:!0}}),window.vslypbjs.setConfig(n),Date.now());bn.o(190,c,!1),window.vslypbjs.requestBids({timeout:bn.G(c,I.hn,I.mn),bidsBackHandler:function(n){for(var e=[],n=(n&&n["ad-outstream"]&&n["ad-outstream"].bids&&(e=e.concat(n["ad-outstream"].bids)),n&&n.video&&n.video.bids&&(e=e.concat(n.video.bids)),bn.n("PREBID : bidsBackHandler : "+JSON.stringify(e)),bn.z()),o=(n.prebid_request_latency=Date.now()-f,[]),t=0;t<e.length;t++)o.push(e[t].bidder);n.prebid_bidders_list=o.join(","),bn.o(191,c,!1,"&dbpl="+encodeURIComponent(JSON.stringify(n))),m(c,e,i)}})}else setTimeout(function(){p(c,i)},10)},m=function(n,s,e){for(var o=[],t=[],c={appnexus:"optimized"===conf.type||"top"==conf.template.sdk.initial_position?"16":"39",bricks:"47",hawkbricks:"48",teads:"57",smartadserver:"62",criteo:"59",ix:"63",pubmatic:"64",rubicon:"66",openx:"67",sharethrough:"68",grid:"69",adyoulike:"70",improvedigital:"71",triplelift:"72",unruly:"73",adot:"74",oftmedia:"75",adkernel:"76",medianet:"77",amx:"78",nobid:"79","improvedigital-outstream":"80","openx-outstream":"82","rubicon-outstream":"83","grid-outstream":"86","oftmedia-outstream":"88"},i=hn.t(n),a=0;a<e.length;a++){var r=e[a].params.vastIndex||e[a].params.vast_index;o.push(r)}bn.n("PREBID : bidders_in_bucket_by_vast_index : "+o.toString());for(a=0;a<s.length;a++){var l=s[a];if(bn.n("PREBID : bidder : "+l.bidder+" with vast_index : "+c[l.bidder]),c[l.bidder])for(var f=0;f<i.vasts.length;f++){var u=i.vasts[f];if(bn.n("PREBID : search a VAST that match bidder : "+k(u)),u.id_vast_type==c[l.bidder]&&vn(u)&&-1<o.indexOf(u.vast_index)){bn.n("PREBID : bidder : "+l.bidder+" with vast_index : "+c[l.bidder]+" matched this VAST : "+k(u)),t.push(u.vast_index),v(n,u,l);break}}}if(t.length&&(bn.n("PREBID : we matched bidReponses with those vast_index : "+t),G(i.vasts)),t.length!=e.length)for(a=0;a<e.length;a++){r=e[a].params.vastIndex||e[a].params.vast_index;-1===t.indexOf(r)&&(u=i.vasts[bn.V(i.vasts,"vast_index",r)],bn.n("PREBID : Missing bid response for : "+k(u)),"0"!=i.id_session_video.charAt(0)&&"1"!=i.id_session_video.charAt(0)||bn.o(159,n,!1,R(u,n,!0)+q()),V.call("Missing bid response","AD_LOAD_ERROR",n,r))}},v=function(n,e,o){o.vastUrl&&(e.url=o.vastUrl),o.vastXml&&(e.responseXml=o.vastXml),o.ad&&(e.adContent=o.ad),e.obpf=o.cpm,e.obpc=o.currency?o.currency.toUpperCase():null,e.pf=o.cpm,e.currency=o.currency?o.currency.toUpperCase():null,o.nurl&&(e.winning_notice_urls=o.nurl),bn.v(e,"EUR",5),e.bpf=e.pf,bn.n("Â¨PREBID : parse prebid response for : "+k(e)+" : pf="+e.pf),d(n,e.vast_index)},y=function(o,t){var c;bn.n("APS : retry n."+i),void 0!==window.apstag&&window.apstag.debug?(bn.n("APS : requesting bids"),c=Date.now(),bn.o(215,o,!1),window.apstag.fetchBids({slots:[{slotID:bn.j()?"Autoplay":"Clicktoplay",mediaType:"video",sizes:[[640,480]]}],timeout:2e3},function(n){bn.n("APS : bids request done");var e=bn.z();e.amazon_request_latency=Date.now()-c,bn.o(216,o,!1,"&dbpl="+encodeURIComponent(JSON.stringify(e))),g(o,t,n)})):i<10?(i+=1,setTimeout(function(){y(o,t)},200)):(bn.n("APS : could not load the library. Skipping Amazon bids."),g(o,t,{}))},g=function(n,e,o){var t=hn.t(n),e=t.vasts[bn.V(t.vasts,"vast_index",e)];0<o.length?(bn.n("APS : bids received "+JSON.stringify(o)),conf.advertising.aips[o[0].amznbid]?(e.url="https://aax.amazon-adsystem.com/e/dtb/vast?b="+o[0].amzniid+"&rnd="+Math.floor(1e13*Math.random())+"&pp="+o[0].amznbid,e.obpf=conf.advertising.aips[o[0].amznbid],e.obpc=e.currency,e.pf=conf.advertising.aips[o[0].amznbid],bn.v(e,"EUR",5),bn.y(e),e.epf=e.pf,e.aer=e.pf,G(t.vasts),d(n,e.vast_index)):(bn.n("APS : Request for VAST "+k(e)+" did not return any valid id. Skipping ad request."),conf.advertising.aipsi[o[0].amznbid]?bn.o(161,n,!1,R(e,n,!0)+"&aem=amazon_invalid_id&aeim="+o[0].amznbid):bn.o(161,n,!1,R(e,n,!0)+"&aem=amazon_missing_id&aeim="+o[0].amznbid),e.ad=!1,0!=I.mn||r||L(n))):(bn.n("APS : Request for VAST "+k(e)+" did not return any bid. Skipping ad request."),bn.o(161,n,!1,R(e,n,!0)+"&aem=amazon_no_bid"),e.ad=!1,0!=I.mn||r||L(n))},d=function(e,o){var t=hn.t(e),c=t.vasts[bn.V(t.vasts,"vast_index",o)];if(-1<c.url.indexOf("pubads.g.doubleclick.net")&&Tn++,bn.n(_+"Request "+k(c)),"15"==c.id_ssp)c.adContent?V.call({},"ADS_MANAGER_LOADED",e,o):V.call("Teads error : no ad element","AD_LOAD_ERROR",e,o);else{c.adsLoader=new google.ima.AdsLoader(xn),bn.I(c.adsLoader,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(n){V.call(n,"ADS_MANAGER_LOADED",e,o)}),bn.I(c.adsLoader,google.ima.AdErrorEvent.Type.AD_ERROR,function(n){V.call(n.getError(),"AD_LOAD_ERROR",e,o)});var n,i=new google.ima.AdsRequest;for(n in i.vastLoadTimeout=bn.G(e,I.hn,I.mn,c),i.forceNonLinearFullSlot=!0,i.linearAdSlotWidth=hn.l.r.offsetWidth,i.linearAdSlotHeight=hn.l.r.offsetHeight,i.nonLinearAdSlotWidth=hn.l.r.offsetWidth,i.nonLinearAdSlotHeight=hn.l.r.offsetHeight,Pn&&(i.pageUrl=conf.page.url),i.setAdWillAutoPlay(hn.Cn.$()),i.setAdWillPlayMuted(conf.template.mute),i.omidAccessModeRules={},google.ima.OmidVerificationVendor)i.omidAccessModeRules[google.ima.OmidVerificationVendor[n]]=google.ima.OmidAccessMode.FULL;c.request_timestamp=Date.now(),c.prebid&&c.responseXml?(i.adsResponse=c.responseXml,c.adsLoader.requestAds(i,hn.l.r)):1==c.xhr?bn.A(c.url,"GET",!0,bn.G(e,I.hn,I.mn,c),function(n,e){if(c.response_timestamp||(c.response_timestamp=Date.now()),n&&""!=n){c.text?i.adsResponse=c.text:(i.adsResponse=n,c.text=n);try{c.responseXML=(new window.DOMParser).parseFromString(c.text,"text/xml")}catch(n){bn.n(_+"Error: Server response contained invalid XML : "+n)}var o;"4"!=c.id_ssp&&"10"!=c.id_ssp||!c.responseXML||(n=c.responseXML.getElementsByTagName("Price")).length&&n[0].childNodes.length&&(o=Number(n[0].childNodes[0].nodeValue),n=n[0].getAttribute("currency"),bn.n(_+"stickyPricing = "+o),o&&n&&(c.obpf=o,c.obpc=n.toUpperCase(),c.pf=o,c.currency=n.toUpperCase(),bn.v(c,"EUR",5),bn.y(c),c.bpf=c.pf,G(t.vasts))),c.adsLoader.requestAds(i,hn.l.r)}else c.xhr=!1,i.adTagUrl=c.url,c.adsLoader.requestAds(i,hn.l.r)}):(i.adTagUrl=c.url,c.adsLoader.requestAds(i,hn.l.r))}"0"!=t.id_session_video.charAt(0)&&"1"!=t.id_session_video.charAt(0)||bn.o(159,e,!1,R(c,e,!0)+q())},V=function(n,e,o){I.yn++;var t,c,i,a=hn.t(e),o=a.vasts[bn.V(a.vasts,"vast_index",o)];bn.n(_+"Response : "+n+" "+k(o)),o.response_timestamp||(o.response_timestamp=Date.now()),"ADS_MANAGER_LOADED"===n?("46"==o.id_vast_type&&(En.push(o.id_vast_type),bn.n("_BAN_GOOGLE="+An.join(",")+","+En.join(","))),o.response=this,bn.o(160,e,!1,R(o,e,!0)),o.ad=!0):(-1<o.url.indexOf("pubads.g.doubleclick.net")&&(x(o)?An.push(x(o)):En.push(o.id_vast_type),-1==o.id_ssp&&(conf.advertising.linear.primary=!1),-2==o.id_ssp&&(conf.advertising.linear.passback=!1),bn.n("_BAN_GOOGLE="+En.join(",")+","+An.join(","))),c="",i=!1,"object"==typeof(t=this)&&(c=(c=(c=(c+="&aem="+t.getMessage())+"&aec="+t.getErrorCode())+"&aevc="+t.getVastErrorCode())+"&aet="+t.getType(),"The VAST response document is empty."==t.getMessage()&&(i=!0),900!=t.getVastErrorCode()&&901!=t.getVastErrorCode()||!t.getInnerError()||(c+="&aeim="+encodeURIComponent(t.getInnerError()))),"string"==typeof t&&(c+="&aem="+t,"Missing bid response"==t&&(i=!0)),"AD_LOAD_ERROR"===n&&!1===i&&bn.o(161,e,!1,R(o,e,!0)+c),"AD_ERROR"===n&&bn.o(165,e,!1,R(o,e,!0)+c),o.ad=!1),e!=conf.admin.current_index&&e!=ad.bn||r?(bn.n(_+"Response a_video_index "+e+" (vid: "+a.vid+") doesn't match current a_video_index "+conf.admin.current_index+" (vid: "+hn.An(conf.admin.current_index)+") or ima is prefetching ("+r+")"),I.yn===a.vasts.length&&hn.en.En(conf.admin.current_index),"AD_ERROR"===n&&L(conf.admin.current_index),e!=conf.admin.current_index&&e!=ad.bn||hn.Pn().On(e)):o.state!=s&&L(e)},w=function(n){t(n)||(K(n),bn.n("* * -> no buyers"),bn.o(176,n,!0,R(null)),_n.o("noBuyers"),X(_+"no buyers",!1))},b=function(n){bn.n(_+"Request VAST primary");var e=hn.t(n),o=JSON.parse(JSON.stringify(conf.advertising.linear.primary)),t="unknown";if(conf.page.grapeshot)if(1==conf.page.grapeshot.gv_safe)t="safe";else if(conf.page.grapeshot.gs_channels)for(var c=conf.page.grapeshot.gs_channels.split(","),i=0;i<c.length;i++)"gv_safe"!=c[i]&&0==c[i].indexOf("gv_")&&(t="unsafe");e.vasts_string||(e.vasts_string=JSON.stringify(e.vasts),e.vasts=[]),o.url=o.url.replace("%%GDPR_APPLIES%%",conf.page.tcf.gdprApplies?"1":"0"),o.url=o.url.replace("%%GDPR_NPA%%",conf.page.usp.applies?1:0),o.url=o.url.replace("%%GDPR_CONSENT%%",conf.page.tcf.tcString),o.url=o.url.replace("%%PLAYLIST_INDEX%%",hn.Nn(n)),o.url=o.url.replace("%%GV_SAFE%%",t),o.url=o.url.replace("%%BRAND_SAFE%%",t),o.url=o.url.replace("%%MUTE%%",1==conf.template.mute&&1==bn.j()&&1==hn.Cn.$()?"true":"false"),o.url=o.url.replace("%%CATEGORY%%",e.category.name),o.url=o.url.replace("%%AUDIENCE_SOURCE%%",conf.page.audience_source.name),o.url=o.url.replace("%%TOP_OF_PAGE%%",hn.s()),o.url=o.url.replace("%%ABOVE_THE_FOLD%%",hn.f()),-1<o.url.indexOf("ads.stickyadstv.com")&&(hn.Dn()&&(o.url+="&playbackMethod="+hn.Dn()),(wn||On||Pn)&&(o.url+="&schain=1.0,1!viously.com,"+conf.admin.ad_seller_id+",1,,,"),o.url.indexOf("&timestamp=")<0&&(o.url+="&timestamp="+Math.floor(1e13*Math.random()))),o.ad_infos_event="",o.vast_index=mn(n,o.id_vast_type),o.ad_index=I.hn,o.ad="waiting",o.bucket_index=o.id_ssp,e.vasts.push(o),d(n,o.vast_index)},t=function(n){if(-2==u)return!1;bn.n(_+"Going through Viously VAST buckets");var e,o=hn.t(n),t=[];for(e in o.backfill_buckets)if(null==u||u<e){if(bn.n(_+"Request Viously VAST bucket "+e),u=e,o.synchronous_vasts.length?(Z(n,o.synchronous_vasts.shift(),parseInt(I.hn)),o.first_reserve_vast_called=!0):o.first_reserve_vast_called=!1,J(o.backfill_buckets[e]),H(o.backfill_buckets[e]),!o.backfill_buckets[e].length)return!1;for(var c in o.backfill_buckets[e]){c=JSON.parse(JSON.stringify(o.backfill_buckets[e][c]));F(c.id_vast_type)&&o.first_reserve_vast_called?(bn.n(_+"Vast "+k(c)+" goes to vasts reserve list"),o.synchronous_vasts.push(c)):(pn(n,c,parseInt(I.hn)),o.vasts.push(c),c.aps?y(n,c.vast_index):c.prebid?t.push(c.prebid_bidder):d(n,c.vast_index),F(c.id_vast_type)&&(o.first_reserve_vast_called=!0))}return t.length&&p(n,t),!0}return bn.n(_+"No buckets left to use"),u=-2,!!conf.advertising.linear.passback&&(U(n),!0)},U=function(n){bn.n(_+"Request Publisher VAST passback");var e=hn.t(n),o=JSON.parse(JSON.stringify(conf.advertising.linear.passback)),t="unknown";if(conf.page.grapeshot)if(1==conf.page.grapeshot.gv_safe)t="safe";else if(conf.page.grapeshot.gs_channels)for(var c=conf.page.grapeshot.gs_channels.split(","),i=0;i<c.length;i++)"gv_safe"!=c[i]&&0==c[i].indexOf("gv_")&&(t="unsafe");o.url=o.url.replace("%%GDPR_APPLIES%%",conf.page.tcf.gdprApplies?"1":"0"),o.url=o.url.replace("%%GDPR_NPA%%",conf.page.usp.applies?1:0),o.url=o.url.replace("%%GDPR_CONSENT%%",conf.page.tcf.tcString),o.url=o.url.replace("%%PLAYLIST_INDEX%%",hn.Nn(n)),o.url=o.url.replace("%%GV_SAFE%%",t),o.url=o.url.replace("%%BRAND_SAFE%%",t),o.url=o.url.replace("%%MUTE%%",1==conf.template.mute&&1==bn.j()&&1==hn.Cn.$()?"true":"false"),o.url=o.url.replace("%%CATEGORY%%",e.category.name),o.url=o.url.replace("%%AUDIENCE_SOURCE%%",conf.page.audience_source.name),o.url=o.url.replace("%%TOP_OF_PAGE%%",hn.s()),o.url=o.url.replace("%%ABOVE_THE_FOLD%%",hn.f()),-1<o.url.indexOf("ads.stickyadstv.com")&&(hn.Dn()&&(o.url+="&playbackMethod="+hn.Dn()),(wn||On||Pn)&&(o.url+="&schain=1.0,1!viously.com,"+conf.admin.ad_seller_id+",1,,,"),o.url.indexOf("&timestamp=")<0&&(o.url+="&timestamp="+Math.floor(1e13*Math.random()))),o.ad_infos_event="",o.vast_index=mn(n,o.id_vast_type),o.ad_index=I.hn,o.ad="waiting",o.bucket_index=o.id_ssp,e.vasts.push(o),d(n,o.vast_index)},L=function(n,e){var o=hn.t(n);if(null==I.gn)if(bn.n(_+"Competition "+o.vid),o.vasts.length)for(var t=0,c=o.vasts.length,i=null;t<c;t++){if(!0===(i=o.vasts[t]).ad){bn.n("* * "+k(i)+" -> "+i.ad),I.bn=n,I.gn=i.vast_index,B(n,i.vast_index);break}if(!1!==i.ad){bn.n("* * "+k(i)+" -> "+i.ad);break}if(-1==i.id_ssp&&t==c-1)return bn.n(_+"Fallback to Viously's VASTs"),o.vasts=JSON.parse(o.vasts_string),delete o.bidder_timestamp,N(n);if(bn.n("* * "+k(i)+" -> "+i.ad),t==c-1){o.synchronous_vasts.length&&!e?Z(n,o.synchronous_vasts.shift(),parseInt(I.hn)):w(n);break}}else o.synchronous_vasts.length&&!e?Z(n,o.synchronous_vasts.shift(),parseInt(I.hn)):w(n);else bn.n(_+"ID "+I.gn+" from vid "+o.vid+" already win")},M=function(n){for(var e=hn.t(n),o=0,t=e.vasts.length,c=null;o<t;o++)if(!0===(c=e.vasts[o]).ad)return c.bpf||c.aer||c.pf;return null},B=function(s,m){var e=null,f=hn.t(s),d=f.vasts[bn.V(f.vasts,"vast_index",m)],p=(bn.n(_+"Manage "+k(d)),d.winning_notice_urls&&bn.F(d.winning_notice_urls),"15"==d.id_ssp?(parent.document.getElementById("ad-outstream")?e=parent.document.getElementById("ad-outstream"):((e=document.createElement("div")).id="ad-outstream",_n.Y.firstChild.appendChild(e)),e.setAttribute("style","width:100%!important;height:100%!important;")):((i=new google.ima.AdsRenderingSettings).restoreCustomPlaybackStateOnAdBreakComplete=!0,i.loadVideoTimeout=1e3*conf.admin.ad_load_video_timeout,i.useStyledLinearAds=!1,i.useStyledNonLinearAds=!0,i.uiElements=[],(h=d.response.getAdsManager(hn.l.r,i)).setVolume(conf.template.mute?0:1)),function(n){var e=n.type;switch("adProgress"!=e&&bn.n(_+e+" : "+k(d)),e){case"loaded":case"start":case"impression":if((i="function"==typeof n.getAd?n.getAd():null)&&(a=i.getAdPodInfo(),d.ad_infos_event="&auai="+i.getUniversalAdIdValue()+"&avmb="+i.getVastMediaBitrate()+"&awai="+i.getWrapperAdIds()+"&awas="+i.getWrapperAdSystems()+"&awci="+i.getWrapperCreativeIds()+"&aat="+i.getTitle()+"&aai="+i.getAdId()+"&aan="+i.getAdvertiserName()+"&acai="+i.getCreativeAdId()+"&aci="+i.getCreativeId()+"&adi="+i.getDealId()+"&aad="+(i.getDuration()?parseInt(i.getDuration()):-1)+"&avmh="+i.getVastMediaHeight()+"&avmw="+i.getVastMediaWidth()+"&amt="+i.getContentType(),a&&(d.ad_infos_event+="&avpi="+a.getAdPosition()+"&avtp="+a.getTotalAds()),d.ad_infos||(d.ad_infos={}),i.getWrapperAdIds()&&i.getWrapperAdIds().length&&i.getDuration()&&(d.ad_infos.creative_unique_id="d"+parseInt(i.getDuration())+"_"+i.getWrapperAdIds())),"loaded"==e){h&&h.setVolume(conf.template.mute?0:1),hn.Vn("ad-buffering"),bn.o(162,null,!1,R(d,null,!0));var o="";try{o=window.btoa(i.getTitle())}catch(n){}i&&i.getTitle()&&conf.advertising.broad&&0<=conf.advertising.broad.indexOf(o)&&(d.killed_at_load=!0,h&&h.stop(),bn.n(_+"Advertiser not allowed. Ad ignored."),bn.o(193,null,!1,R(d)+"&aem=advi")),d.ad_infos&&d.ad_infos.creative_unique_id&&0<=O.indexOf(d.ad_infos.creative_unique_id)&&(d.killed_at_load=!0,h&&h.stop(),bn.n(_+"Creative id is broken. Ad ignored."),bn.o(193,null,!1,R(d)+"&aem=broken_creative"))}"impression"==e&&(_n.o("adImpression"),bn.o(164,null,!1,R(d))),"start"==e&&("15"!=d.id_ssp?hn.Vn("advertising"):hn.Vn("ad-outstream"),_n.o("adStart"),_n.X(),bn.o(163,null,!1,R(d,null,!0)+q()),clearTimeout(S),clearTimeout(D),i&&(o=-2,"3"==d.id_ssp&&(o=parseInt(i.getSkipTimeOffset())),d.skippable&&(parseInt(i.getDuration())<=d.skip_ad_in||0<=o&&o<=d.skip_ad_in)&&(d.skippable=!1)),I.mn=!0,d.played=!0,C=!0,hn.Ln.Un(!0),"function"==typeof n.getAd&&(P(),bn.I(window,"resize",P),bn.R(document.getElementById("ad-skip-button"),"click",W),I._n=!1,u=document.getElementById("ad-play-pause"),bn.g(u,"ad-pause"),on(d,n.getAd())&&hn.Bn.Mn(d)),tn(s,d.vast_index));break;case"firstQuartile":bn.o(169,null,!1,R(d)),cn(s,d);break;case"midpoint":bn.o(170,null,!1,R(d));break;case"thirdQuartile":bn.o(171,null,!1,R(d)),conf.admin.refetch_played_ads&&I.hn+1<conf.template.advertising.linear.max_preroll_viously&&-2!=d.id_ssp&&sn(s,d.id_vast_type,x(d));break;case"skip":bn.o(168,null,!1,R(d,null,!0)),(i=n.getAd())&&(a=i.getAdPodInfo())&&a.getAdPosition()<a.getTotalAds()&&h&&h.stop();break;case"userClose":bn.o(167,null,!1,R(d,null,!0));break;case"complete":bn.o(166,null,!1,R(d,null,!0)),(i="function"==typeof n.getAd?n.getAd():null)&&(a=i.getAdPodInfo())&&a.getAdPosition()<a.getTotalAds()&&h&&h.stop(),E=setTimeout(function(){p({type:"allAdsCompleted"})},1e3);break;case"allAdsCompleted":if(clearTimeout(E),hn.Vn("buffering"),!0===I.pn)if(yn(d)||I.hn++,bn.n(_+"ADS COMPLETED = "+I.hn),I.hn>=conf.template.advertising.linear.max_preroll_viously)bn.o(183,null,!1,R(d)),I.hn=0,hn.zn(conf.admin.current_index),Q(!0),_n.o("allAdsCompleted");else if("15"!=d.id_ssp&&(h&&h.destroy(),d.adsLoader.contentComplete()),d.ad=!1,_n.o("adComplete"),yn(d)||Q(!0),-1==d.id_vast_type&&(d.ad=!1),d.killed){delete f.bidder_timestamp;for(var t=f.vasts.length;t--;){var c=f.vasts[t];c.vast_index===d.vast_index?f.vasts.splice(t,1):(delete c.ad,delete c.response,delete c.responseXML,delete c.ad_infos_event,delete c.adsLoader)}N(s)}else d.killed_at_load?Q(!1):bn.o(202,s,!1,"&aaf=linear&adix="+parseInt(I.hn)),L(conf.admin.current_index);s!=conf.admin.current_index&&hn.en.En(conf.admin.current_index);break;case"adProgress":var o="",i="",a=n.getAdData()?n.getAdData().duration:-1,r=n.getAdData()?n.getAdData().currentTime:0,l=h?h.getRemainingTime():0;0<l&&(o=1!==conf.template.advertising.linear.max_preroll_viously&&conf.template.advertising.linear.show_remaining_ads?conf.admin.lng.remainingads.replace("%%INDEX%%",parseInt(I.hn+1)).replace("%%LENGTH%%",conf.template.advertising.linear.max_preroll_viously).replace("%%TIME%%",bn.P(parseInt(l,10))):conf.admin.lng.remaining.replace("xx",parseInt(l,10)),1==d.skippable&&0<d.skip_ad_in&&a>d.skip_ad_in&&((a=-1<l&&-1<a?a-l:-1)>=d.skip_ad_in?(I._n||(bn.I(document.getElementById("ad-skip-button"),"click",W),I._n=!0),1==hn.l.Gn()?o=conf.admin.lng.goskip:i=conf.admin.lng.skiptext):i=conf.admin.lng.skipin.replace("xx",parseInt(d.skip_ad_in-a,10)))),0==r&&(o=conf.admin.lng.loading),""==i?bn.b(document.body,"show-ad-skip"):bn.g(document.body,"show-ad-skip"),document.getElementById("ad-skip-button-text").textContent=i,document.getElementById("ad-countdown").textContent=o,cn(s,d);break;case"adCanPlay":bn.o(177,null,!1,R(d));break;case"contentPauseRequested":bn.o(178,null,!1,R(d));break;case"contentResumeRequested":bn.o(179,null,!1,R(d));break;case"volumeChange":l=!h.getVolume();conf.template.mute!=l&&hn.Z(!!l),!0===conf.template.mute?bn.o(180,null,!1,R(d)):bn.o(181,null,!1,R(d));break;case"click":bn.o(182,null,!1,R(d,null,!0));break;case"videoClicked":bn.o(194,!1,!1,R(d,null,!0));break;case"videoIconClicked":bn.o(195,!1,!1,R(d));break;case"resume":C=!0;var u=document.getElementById("ad-play-pause");bn.g(u,"ad-pause");break;case"pause":C=!1;u=document.getElementById("ad-play-pause");bn.b(u,"ad-pause");break;case"error":"15"!=d.id_ssp&&(h.destroy(),d.adsLoader.contentComplete()),Q(!1);for(t=f.vasts.length;t--;)f.vasts[t].id_vast_type==d.id_vast_type&&f.vasts[t].refetched&&(f.vasts[t].ad=!1);V.call(n.error,"AD_ERROR",s,m)}});if("15"==d.id_ssp){p({type:"loaded"}),T=setInterval(function(){w()},100),A=setTimeout(function(){bn.n("TEADS : Timeout"),clearInterval(T),!1===o?(bn.n("Teads error : no teads-player class found"),p({type:"error",error:"Teads error : no teads-player class found"})):(cn(s,d),e.querySelector(".teads-player iframe")?t?(bn.n("Teads error : unknown error"),p({type:"error",error:"Teads error : unknown error"})):""==t.src?(bn.n("Teads error : no video src found"),p({type:"error",error:"Teads error : no video src found"})):(bn.n("Teads error : no video found"),p({type:"error",error:"Teads error : no video found"})):(bn.n("Teads error : iframe removed"),p({type:"error",error:"Teads error : iframe removed"}))),y()},6e3);var o=!1,a=!1,t=null,r=!1,l=!1,u=!1,n=!1,v=10,y=function(){document.body.removeAttribute("style"),e.innerHTML="",e.setAttribute("style","display:none!important;"),bn.b(e,"ad-outstream-squared")},c=function(){bn.n("TEADS : ended"),!1===n&&(n=!0,clearInterval(T),cn(s,d),t&&(bn.R(t,"timeupdate",g),conf.user.device.browser&&conf.user.device.browser.name&&"safari"!==conf.user.device.browser.name.toLowerCase()&&bn.R(t,"ended",c)),y(),p({type:"complete"}),setTimeout(function(){p({type:"allAdsCompleted"})},100))},g=function(){cn(s,d),!1===r&&t.currentTime>=t.duration/4&&(r=!0,p({type:"firstQuartile"})),!1===l&&t.currentTime>=t.duration/2&&(l=!0,p({type:"midpoint"})),!1===u&&t.currentTime>=3*t.duration/4&&(u=!0,p({type:"thirdQuartile"})),conf.user.device.browser&&conf.user.device.browser.name&&"safari"===conf.user.device.browser.name.toLowerCase()&&!1===n&&t.currentTime>=t.duration-1&&setTimeout(function(){!1===n&&c()},1500)},w=function(){var n;!1===o&&(e.querySelector("video")||e.querySelector(".teads-player iframe")&&0<e.querySelector(".teads-player iframe").offsetHeight)&&(bn.n("TEADS : player found"),o=!0,n=e.querySelector(".teads-player iframe")||e.querySelector("video"),bn.n("TEADS : "+n.offsetWidth+"w * "+n.offsetHeight+"h"),n.offsetHeight==n.offsetWidth&&(a=!0),document.body.removeAttribute("style"),e.removeAttribute("style"),!0===a&&(bn.O("#ad-outstream.ad-outstream-squared{width:"+_n.Y.offsetHeight+"px!important;height:"+_n.Y.offsetHeight+"px!important;left:50%!important;margin-left:-"+_n.Y.offsetHeight/2+"px!important;}","ad-outstream-squared-style",e),bn.g(e,"ad-outstream-squared")),p({type:"impression"}),p({type:"start"}),parent.viously.fn.tdsCmplt=c,cn(s,d));try{t=(t=(t=(t=(t=(t=e.querySelector("video"))||e.querySelector("iframe:not([src])").contentWindow.document.getElementsByTagName("video")[0])||e.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.getElementsByTagName("video")[0])||e.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.getElementsByTagName("video")[0])||e.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.getElementsByTagName("video")[0])||e.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.querySelector("iframe:not([src])").contentWindow.document.getElementsByTagName("video")[0]}catch(n){}t&&""!=t.src&&(bn.n("TEADS : video found"),clearTimeout(A),clearInterval(T),!0===t.paused&&t.play(),bn.o(177,null,!1,R(d)),bn.I(t,"pause",function(){bn.n("TEADS : pause"),0!=v&&(bn.n("TEADS : play"),t.play(),v--)}),bn.I(t,"timeupdate",g),conf.user.device.browser&&conf.user.device.browser.name&&"safari"!==conf.user.device.browser.name.toLowerCase()&&bn.I(t,"ended",c))},i=document.createElement("iframe"),i=(i.setAttribute("width",1),i.setAttribute("height",1),i.setAttribute("frameborder",0),document.body.appendChild(i),i.contentDocument||i.contentWindow.document||i.document);i.open(),i.write("<!DOCTYPE html><html><head></head><body>"+d.adContent+"</body></html>"),i.close()}else{for(var b in google.ima.AdEvent.Type)bn.I(h,google.ima.AdEvent.Type[b],p);bn.I(h,google.ima.AdErrorEvent.Type.AD_ERROR,function(n){p({type:"error",error:n.getError()})})}I.pn=!0,Y(s),_n.o("adReady")},R=function(n,e,o){var t="";return n?(n.id_vast_type&&(t+="&aivt="+n.id_vast_type),n.name&&(t+="&anvt="+n.name),x(n)&&(t+="&asvt="+x(n)),n.id_ssp&&(t+="&ais="+n.id_ssp),n.ssp_name&&(t+="&ans="+n.ssp_name),n.placement&&(t+="&apl="+(n.placement||"none")),n.pf&&(t+="&arpm="+n.pf),n.epf&&(t+="&aerpm="+(n.epf||0)),n.bpf&&(t+="&abrpm="+(n.bpf||0)),n.obpf&&(t+="&aobrpm="+(n.obpf||0)),n.obpc&&(t+="&aobpc="+(n.obpc||0)),t+="&adix="+(n.ad&&"refetching"===n.ad?parseInt(I.hn+1):parseInt(I.hn)),n.passback_viously&&(t+="&pbv="+!!n.passback_viously),t=(t+="&aapf="+(n.key_values&&n.key_values.vsl_floor?n.key_values.vsl_floor:"legacy"))+"&aapfv="+(n.key_values&&n.key_values.vsl_floor_version?n.key_values.vsl_floor_version:""),o&&(t+="&dbpl="+encodeURIComponent(JSON.stringify(bn.z(n,e)))),t=(t=(t=(t+="&aapv="+In)+"&aapw="+(n.rpm_weight||1))+"&avt="+z(n))+"&aif="+(1==n.outstream?"outstream":"instream"),n.ad_infos_event&&(t+=n.ad_infos_event),t+="&abix="+n.bucket_index):t+="&adix="+parseInt(I.hn),t=t+("&aivpm="+Rn)+"&aaf=linear",hn.Dn()&&(t+="&ppm="+hn.Dn()),t},z=function(n){return-1==n.id_ssp?"primary":-2==n.id_ssp?"passback":"viously"},k=function(n){return(n.ssp_name?n.ssp_name+" ":"")+(n.name?n.name+" ":"")+(n.vast_index||n.id_vast_type)+(x(n)?" ("+x(n)+")":"")},x=function(n){return n.key_values&&n.key_values.v2_dmd?n.key_values.v2_dmd:null},G=function(n){"function"==typeof Array.prototype.sort&&(n.sort(function(n,e){var o,t;return 0===In.indexOf("api")?(o=n.bpf||n.aer||n.pf,t=e.bpf||e.aer||e.pf,n.rpm_weight&&(o*=n.rpm_weight),e.rpm_weight&&(t*=e.rpm_weight),t-o):e.pf-n.pf}),"function"==typeof Array.prototype.forEach&&(bn.n(_+"Sort :"),n.forEach(function(n){var e;0===In.indexOf("api")?(e=n.bpf||n.aer||n.pf,n.rpm_weight&&(e*=n.rpm_weight),bn.n("* * "+k(n)+" -> "+e+n.currency+" -> "+n.ad)):bn.n("* * "+k(n)+" -> "+n.pf+n.currency+" -> "+n.ad)})))},q=function(){var n="";return conf.advertising.linear.pred&&conf.advertising.linear.pred.vtr&&(conf.advertising.linear.pred.vtr.dur&&(n+="&vpad="+encodeURIComponent(bn.p(conf.advertising.linear.pred.vtr.dur))),conf.advertising.linear.pred.vtr.disabled_features&&(n+="&vpadf="+conf.advertising.linear.pred.vtr.disabled_features.join(","))),n},F=function(n){return-1<conf.advertising.svt.indexOf(n)},J=function(n){if(Tn==conf.admin.max_dfp_ad_requests){bn.n(_+"Max Google ad requests reached");for(var e=n.length;e--;){var o=n[e];-1<o.url.indexOf("pubads.g.doubleclick.net")&&(bn.n(_+"Remove "+k(o)),n.splice(e,1))}conf.advertising.linear.primary&&-1<conf.advertising.linear.primary.url.indexOf("pubads.g.doubleclick.net")&&(bn.n(_+"Remove "+k(conf.advertising.linear.primary)),conf.advertising.linear.primary=!1),conf.advertising.linear.passback&&-1<conf.advertising.linear.passback.url.indexOf("pubads.g.doubleclick.net")&&(bn.n(_+"Remove "+k(conf.advertising.linear.passback)),conf.advertising.linear.passback=!1)}},H=function(n){if(An.length)for(var e=0;e<An.length;e++)for(var o=n.length;o--;)-1<(c=n[o]).url.indexOf("pubads.g.doubleclick.net")&&x(c)==An[e]&&(bn.n(_+"BAN "+k(c)),n.splice(o,1));if(En.length)for(var t=0;t<En.length;t++)for(var c,o=n.length;o--;)-1<(c=n[o]).url.indexOf("pubads.g.doubleclick.net")&&c.id_vast_type==En[t]&&(bn.n(_+"BAN "+k(c)),n.splice(o,1))},j=function(n){if(conf.advertising.linear.pred&&conf.advertising.linear.pred.vtr&&conf.advertising.linear.pred.vtr.dur){if(conf.advertising.linear.pred.vtr.dur[30]<75)for(var e=n.length;e--;)"61"==(o=n[e]).id_vast_type&&(bn.n(_+"Remove "+k(o)),n.splice(e,1));if(conf.advertising.linear.pred.vtr.dur[30]<80)for(var o,e=n.length;e--;)"65"==(o=n[e]).id_vast_type&&(bn.n(_+"Remove "+k(o)),n.splice(e,1))}},Y=function(n){var e,o,t;bn.n(_+"before start"),!I.pn&&!I.wn||!0!==hn.Cn.$()&&!0!==hn.Sn.$()||(null!=(e=I.gn)?(void 0===n&&(n=I.bn),o=hn.t(n),t=o.vasts[bn.V(o.vasts,"vast_index",e)],bn.n(_+"adsManager start : "+k(t)),"15"!=t.id_ssp&&(bn.I(document.getElementById("ad-play-pause"),"click",nn),bn.I(document.getElementById("ad-volume"),"click",en),c(),h.init(hn.l.r.offsetWidth,hn.l.r.offsetHeight,google.ima.ViewMode.NORMAL,hn.l.r),h.setVolume(conf.template.mute?0:1),h.start()),bn.o(186,n,!1,R(t,n,!0)),S=setTimeout(function(){null!=e&&0==I.mn&&(bn.n(_+"KILL ADSMANAGER : "+k(t)),t.killed=!0,"15"!=t.id_ssp?(t.adsLoader.destroy(),h.destroy()):(clearTimeout(A),clearInterval(T)),Q(!1),t.ad_infos&&t.ad_infos.creative_unique_id&&O.push(t.ad_infos.creative_unique_id),V.call("KILL ADSMANAGER","AD_ERROR",n,e))},1e3*conf.admin.ad_load_video_timeout)):(I.wn=!1,hn.zn(conf.admin.current_index)))},X=function(n,e){bn.n(n),hn.Vn("idle"),I.wn=!0,Y(),Q(e)},W=function(){bn.R(document.getElementById("ad-skip-button"),"click",W),1==h.getAdSkippableState()?h.skip():h.stop()},Q=function(n){clearTimeout(S),clearTimeout(D),bn.R(window,"resize",P),bn.b(document.body,"show-ad-skip"),I.pn=!1,I.mn=!1,I.vn=null,I.yn=0,I.gn=null,I.bn=conf.admin.current_index,I.Rn=!1,I.kn=-1,I.xn=!1,bn.R(document.getElementById("ad-play-pause"),"click",nn),bn.R(document.getElementById("ad-volume"),"click",en),I.In&&I.In.disconnect(),n&&(u=null),document.getElementById("ad-outstream")&&(clearTimeout(A),clearInterval(T),document.body.removeAttribute("style"),document.getElementById("ad-outstream").innerHTML="",document.getElementById("ad-outstream").setAttribute("style","display:none!important;"))},K=function(n){bn.n(_+"Empty reserve VASTs list");n=hn.t(n);n.synchronous_vasts=[],n.first_reserve_vast_called=!1},Z=function(n,e,o){var t=hn.t(n);bn.n(_+"Add Vast "+k(e)+" to competition"),pn(n,e,o),t.vasts.push(e),G(t.vasts),(e.aps?y:d)(n,e.vast_index)},$=function(n){var e=hn.t(n);if(e.synchronous_vasts.length){var n=M(n),e=e.synchronous_vasts.shift(),o=e.aer||e.pf;if(n<o)return bn.n(_+"Highest positive price available is lower than the price of the vast reserve ("+n+" < "+o+"). We return the reserved vast."),e;bn.n(_+"Highest positive price available is higher than the price of the vast reserve ("+n+" > "+o+"). We do not call them.")}return null},nn=function(){h&&(C?h.pause():h.resume())},en=function(){hn.Z(!conf.template.mute)},on=function(n,e){var o=new google.ima.CompanionAdSelectionSettings,t=(o.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType.ALL,o.creativeType=google.ima.CompanionAdSelectionSettings.CreativeType.IMAGE,o.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE,e.getCompanionAds(300,250,o));if(t.length){l={vast_index:n.vast_index,list:[]};for(var c=0;c<t.length;c++)l.list.push(t[c])}return!!t.length},tn=function(n,e){var o=wn?parent:window,t=wn?window.frameElement:document.body;"IntersectionObserver"in o?(I.In||(bn.n("MRC : IntersectionObserver: init for ad viewability"),I.In=new o.IntersectionObserver(function(n){n.forEach(function(n){n.target==t&&(.5<=n.intersectionRatio?(I.Rn=!0,-1==I.kn&&(I.kn=bn.c())):(I.Rn=!1,I.kn=-1))})},{threshold:.5})),bn.n("MRC : IntersectionObserver: observe ad viewability"),I.In.observe(t)):(o=(o=hn.t(n)).vasts[bn.V(o.vasts,"vast_index",e)],bn.n("MRC : IntersectionObserver: not supported"),bn.o(185,n,!1,R(o,n)))},cn=function(n,e){var o;I.In&&!I.xn&&I.Rn&&-1!=I.kn&&(o=(bn.c()-I.kn)/1e3,bn.n("MRC : Viewability duration : "+o),2<=o&&(bn.n("MRC : Ad Viewability MRC reached"),bn.o(184,n,!1,R(e,n)),I.xn=!0,I.In.disconnect()))},an=function(n){L(n)},rn=function(){return h},ln=function(){return l},un=function(n){r=n},sn=function(n,e,s){bn.n(_+"refetchVast");var o=hn.t(n);if(o.original_vasts){var t=[],c=[];if(0<e||fn(e)&&!conf.template.advertising.linear.primary_capping){var i=null;if(s)for(var a=0;a<o.original_vasts.length;a++){var r=o.original_vasts[a];if(x(r)==s){i=r;break}}else i=o.original_vasts[bn.V(o.original_vasts,"id_vast_type",e)];i&&(!dn(i)||fn(e)&&!conf.template.advertising.linear.primary_capping)&&t.push(i)}for(var l=0;l<o.vasts.length;l++){var u,r=o.vasts[l];F(r.id_vast_type)||!1===r.ad&&r.ad_index==I.hn&&0<r.id_vast_type&&((u=o.original_vasts[bn.V(o.original_vasts,"id_vast_type",r.id_vast_type)])&&!dn(u)&&t.push(u))}e=$(n);e&&t.push(e),J(t),H(t);for(l=0;l<t.length;l++){var r=JSON.parse(JSON.stringify(t[l])),f=parseInt(I.hn+1);F(r.id_vast_type)?bn.n(_+"Get from reserve : "+k(r)):bn.n(_+"Refetch : "+k(r)),fn(r.id_vast_type)?b(n):(pn(n,r,f),r.refetched=!0,r.ad="refetching",o.vasts.push(r),G(o.vasts),r.aps?y(n,r.vast_index,!0):r.prebid?c.push(r.prebid_bidder):d(n,r.vast_index))}c.length&&p(n,c)}},fn=function(n){return-1==n},dn=function(n){return!!(n.id_vast_type<0||n.passback_viously)},pn=function(n,e,o){var t=hn.t(n);if(e.ad="waiting",e.vast_index=mn(n,e.id_vast_type),e.ad_infos_event="",e.ad_index=o,e.bucket_index=e.id_ssp<0?e.id_ssp:u||1,"17"==e.id_ssp&&(e.obpf=e.pf,e.obpc=e.currency),bn.v(e,"EUR",5),void 0===e.epf&&(e.epf=e.aer||e.pf),"3"==e.id_ssp||"4"==e.id_ssp||"10"==e.id_ssp){var c="",c=(c=(c=(c=(c+="vsl_category="+t.category.name)+("&vsl_video_index="+hn.Nn(n)))+("&vsl_template_id="+conf.template.id))+("&vsl_template_version="+conf.template.version))+("&vsl_ad_index="+o)+("&vsl_vast_type="+e.id_vast_type);for(a in"4"!=e.id_ssp&&"10"!=e.id_ssp||(c+="&co="+encodeURIComponent(e.placement+","+conf.template.id+","+conf.template.version)),1==conf.template.mute&&1==bn.j()&&1==hn.Cn.$()?c+="&vsl_mute=true":c+="&vsl_mute=false",c=(c=(c=(c=(c=(c+="&gdprapplies="+conf.page.tcf.gdprApplies)+("&gdprconsent="+!!conf.page.tcf.tcString))+("&gdprgoogleallowed="+conf.page.tcf.googleAllowed))+("&vsl_consent_type="+conf.page.tcf.consentType))+("&vsl_player_toproll="+hn.s()))+("&vsl_player_atf="+hn.f()),hn.Dn()&&(c+="&vsl_playback_method="+hn.Dn()),conf.page.grapeshot&&(conf.page.grapeshot.gv_safe&&(c+="&vsl_gv_safe="+conf.page.grapeshot.gv_safe),conf.page.grapeshot.gs_channels&&(c+="&vsl_gs_channels="+encodeURIComponent(conf.page.grapeshot.gs_channels)),conf.page.grapeshot.vc_channels&&(c+="&vsl_vc_channels="+encodeURIComponent(conf.page.grapeshot.vc_channels))),c=(c+="&vsl_nonlinear_enable="+(conf.advertising.companion.allowed?"true":"false"))+("&vsl_dar="+conf.advertising.dar.value),e.key_values)c+="&"+a+"="+encodeURIComponent(e.key_values[a]);if(e.key_values&&e.key_values.vsl_floor||(c+="&vsl_floor=legacy"),c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c+="&vsl_prio_version="+In)+("&duid="+conf.diffuser.uid))+("&pasn="+conf.page.audience_source.name))+("&pid="+conf.product.id))+("&udbn="+(conf.user.device.browser&&conf.user.device.browser.name?encodeURIComponent(conf.user.device.browser.name):"")))+("&udon="+(conf.user.device.os&&conf.user.device.os.name?encodeURIComponent(conf.user.device.os.name):"")))+("&ugcn="+(conf.user.geoip.country&&conf.user.geoip.country.name?encodeURIComponent(conf.user.geoip.country.name):"")))+("&udt="+(conf.user.device.type?encodeURIComponent(conf.user.device.type):"")))+("&pnpv="+conf.page.nb_players))+("&pet="+hn.qn())+"&aaf=linear")+("&ptcus="+conf.page.tcf.cmpuistate))+("&pua="+conf.page.usp.applies))+("&uib="+conf.user.is_bot))+("&plv="+t.vid),conf.page.grapeshot){var i=3;if(conf.page.grapeshot.safety)switch(conf.page.grapeshot.safety){case"unsafe":i=0;break;case"safe":i=1;break;case"error":i=2}c+="&pgsy="+i}"3"==e.id_ssp?(e.url+="&gdpr="+(conf.page.tcf.gdprApplies?"1":"0"),e.url+="&gdpr_consent="+conf.page.tcf.tcString,conf.page.tcf.addtlConsent&&0<conf.page.tcf.addtlConsent.indexOf("~")&&(e.url+="&addtl_consent="+conf.page.tcf.addtlConsent),"3"!=e.id_vast_type&&"31"!=e.id_vast_type&&"46"!=e.id_vast_type||(e.url+="&ciu_szs=300x50"),e.url.indexOf("&cust_params=")<0&&(e.url+="&cust_params="+encodeURIComponent(c))):(hn.Dn()&&(c+="&playbackMethod="+hn.Dn()),(wn||On||Pn)&&(c+="&schain=1.0,1!viously.com,"+conf.admin.ad_seller_id+",1,,,"),e.url.indexOf("&timestamp=")<0&&(e.url+="&timestamp="+Math.floor(1e13*Math.random())),e.url+="&"+c)}if("4"!=e.id_ssp&&"10"!=e.id_ssp||(e.url+="&_fw_gdpr="+(conf.page.tcf.gdprApplies?"1":"0"),e.url+="&_fw_gdpr_consent="+conf.page.tcf.tcString),"6"==e.id_ssp){e.prebid=!0;var a,r={gdprapplies:conf.page.tcf.gdprApplies?"true":"false",gdprconsent:conf.page.tcf.tcString?"true":"false",gdprgoogleallowed:""+conf.page.tcf.googleAllowed,vsl_gs_channels:conf.page.grapeshot?conf.page.grapeshot.gs_channels:"",vsl_gv_safe:conf.page.grapeshot&&conf.page.grapeshot.gv_safe?"true":"",vsl_vc_channels:conf.page.grapeshot?conf.page.grapeshot.vc_channels:"",vsl_video_index:hn.Nn(n),vsl_mute:1==conf.template.mute&&1==bn.j()&&1==hn.Cn.$()?"true":"false",vsl_category:t.category.name,vsl_template_id:conf.template.id,vsl_template_version:conf.template.version,vsl_consent_type:conf.page.tcf.consentType,vsl_player_toproll:hn.s()?"true":"false",vsl_player_atf:hn.f()?"true":"false",vsl_ad_index:o,vsl_vast_type:e.id_vast_type,vsl_prio_version:In,vsl_nonlinear_enable:conf.advertising.companion.allowed?"true":"false",vsl_dar:conf.advertising.dar.value,duid:conf.diffuser.uid,pasn:conf.page.audience_source.name,pid:conf.product.id,udbn:conf.user.device.browser&&conf.user.device.browser.name?conf.user.device.browser.name:"",udon:conf.user.device.os&&conf.user.device.os.name?conf.user.device.os.name:"",ugcn:conf.user.geoip.country?conf.user.geoip.country.name:"",udt:conf.user.device.type,pnpv:conf.page.nb_players,pet:hn.qn(),aaf:"linear",ptcus:conf.page.tcf.cmpuistate,pua:conf.page.usp.applies.toString(),uib:conf.user.is_bot.toString(),plv:t.vid};for(a in hn.Dn()&&(r.vsl_playback_method=hn.Dn()),e.key_values)r[a]=e.key_values[a];e.key_values&&e.key_values.vsl_floor||(r.vsl_floor="legacy");var l="auto_play_sound_unknown";if(hn.Dn())switch(hn.Dn()){case 1:case 5:l="auto_play_sound_on";break;case 2:case 6:l="auto_play_sound_off";break;case 3:case 4:l="click_to_play"}e.prebid_bidder={bidder:"appnexus",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,allowSmallerSizes:!0,keywords:r,usePaymentRule:!0,placementId:e.placement,position:hn.f()?"above":"below",supplyType:Dn||"tablet"===(conf.user.device.type&&conf.user.device.type.toLowerCase())?"mobile_web":"web",video:{minduration:0,maxduration:900,context:"pre_roll",skippable:!0,skipoffset:34,playback_method:l,frameworks:[1,2]}}}}"8"==e.id_ssp&&(e.url+="&gdpr="+conf.page.tcf.gdprApplies,e.url+="&gdpr_consent="+conf.page.tcf.tcString),"9"==e.id_ssp&&(e.url+="&gdpr="+(conf.page.tcf.gdprApplies?"1":"0"),e.url+="&gdpr_consent="+conf.page.tcf.tcString,e.url=e.url.replace("%%PLAYLIST_INDEX%%",hn.Nn(n)),e.url=e.url.replace("%%AD_INDEX%%",o)),"13"==e.id_ssp&&(e.url=e.url.replace("%%GDPR_CONSENT%%",conf.page.tcf.tcString),e.url=e.url.replace("%%EXTID2_VALUE%%",encodeURIComponent(conf.template.id+","+conf.template.version))),"14"==e.id_ssp&&(e.prebid=!0,e.prebid_bidder={bidder:x(e)?x(e):"bricks",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,account:"viously",pid:e.placement,endpoint:e.url}}),"15"==e.id_ssp&&(e.prebid=!0,e.outstream=!0,e.prebid_bidder={bidder:"teads",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,websiteId:e.placement.split("_")[0],placementId:e.placement.split("_")[1],pageId:e.placement.split("_")[2]}}),"59"==e.id_vast_type&&(e.prebid=!0,e.prebid_bidder={bidder:"criteo",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,networkId:11086,publisherSubId:conf.diffuser.uid+"_"+conf.product.id}}),"62"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"smartadserver",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,networkId:4163,siteId:578841,pageId:1751320,formatId:105165,bidfloor:1,schain:"1.0,1!viously.com,"+conf.admin.ad_seller_id+",1,,,",video:{protocol:8,startDelay:1}}}),"63"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"ix",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,siteId:"877692",account:"viously",publisherId:"195671"}}),"64"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"pubmatic",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,publisherId:"162545"}}),"66"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"rubicon",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,accountId:22416,siteId:369764,zoneId:2018910,position:hn.f()?"atf":"btf",floor:1,video:{language:t.language.toLowerCase()}}}),"67"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"openx",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,unit:"558414511",delDomain:"viously-d.openx.net"}}),"68"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"sharethrough",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,pkey:"I1lXUzDeSlJH8zOYdKVCmYSR"}}),"69"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"grid",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,uid:376234,bidFloor:1}}),"70"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"adyoulike",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placement:"8314745e6de3a0436a4687fdd4911348"}}),"71"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"improvedigital",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placementId:22872560,publisherId:2154,bidFloor:1,bidFloorCur:"EUR"}}),"72"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"triplelift",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,inventoryCode:"Viously_XandrPSP_Allpublishers",floor:1}}),"73"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"unruly",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,siteId:254497}}),"74"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"adot",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placementId:e.placement}}),"75"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"oftmedia",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placementId:"29329802"}}),"76"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"adkernel",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,host:"cpm.metaadserving.com",zoneId:174960}}),"77"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"medianet",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,cid:"8CU507GON",crid:"323026858",bidfloor:1}}),"78"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"amx",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,tagId:"dmlvdXNseS5jb20"}}),"79"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"nobid",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,siteId:22871729935}}),"80"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.outstream=!0,e.prebid_bidder={bidder:"improvedigital-outstream",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placementId:22968623,publisherId:2154,bidFloor:1,bidFloorCur:"EUR"}}),"81"==e.id_vast_type&&(e.aps=!0),"82"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.outstream=!0,e.prebid_bidder={bidder:"openx-outstream",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,unit:"559254884",delDomain:"viously-d.openx.net"}}),"83"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.outstream=!0,e.prebid_bidder={bidder:"rubicon-outstream",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,accountId:22416,siteId:476858,zoneId:2830676,position:hn.f()?"atf":"btf",floor:.5,video:{language:t.language.toLowerCase()}}}),"86"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.outstream=!0,e.prebid_bidder={bidder:"grid-outstream",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,uid:389660,bidFloor:.5}}),"88"==e.id_vast_type&&(e.s2s=!0,e.prebid=!0,e.prebid_bidder={bidder:"oftmedia-outstream",params:{idVastType:e.id_vast_type,vastIndex:e.vast_index,placementId:"29329676"}}),1==e.wrapped_vpaid&&(e.url=conf.admin.vpaid.url.replace("%%TAG_URL%%",encodeURIComponent(e.url)),e.url+="&si="+e.id_ssp,e.url+="&svt="+e.id_vast_type)},mn=function(n,e){for(var o=hn.t(n),t=1;o.vasts[bn.V(o.vasts,"vast_index",e+"-"+t)];)t++;return e+"-"+t},vn=function(n){return"waiting"===n.ad||"refetching"===n.ad},yn=function(n){return n.killed||n.killed_at_load},gn=function(n){n=hn.t(n);if(0!=conf.admin.current_index||0!=I.hn||n.vasts_string||r)bn.n(_+"DAR : not called at the beginning of the session.");else{var n="vsly_dar_expiration",e=new Date,e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999),o=Mn.rn(n);if(conf.advertising.dar.allowed){if(!o||o<e.getTime())return bn.n(_+"DAR : Calling the dar pixel."),bn.q(conf.advertising.dar.url),Mn.an(n,e.getTime()),!0;bn.n(_+"DAR : Current viously dar has not expired yet. The DAR pixel is not called.")}else bn.n(_+"DAR : not allowed for this session.")}return!1};return n.Fn=rn,n.Jn=N,n.Hn=f,n.jn=o,n.Yn=e,n.Xn=Y,n.Wn=c,n.Qn=ln,n.Kn=un,n.On=an,n.Zn=P,n}(N||{}),hn,hn,V,U,L,M,B,z,G,q,F,J,t,H,j,Y,X,W,o,Q,K,Z,$,u,nn,en,on,tn,cn,an,rn,ln,un,sn,fn,dn,pn,mn,vn,yn,gn,Bn,zn,Gn,qn,Fn,Jn,Hn,jn,Yn,Xn,Wn,Qn,Kn,Zn,$n,ne,ee,oe,te,ce,ie,c,ae,re,le,ue,se,fe,de,pe,me,ve,ye,ge,we,be,_e,he,Ie,Re,ke,xe,Se,Te,Ae,Ee,De,Ce,Oe,Pe,Ne,Ve,Ue,Le,Me,Be,i,ze,Ge,qe,Fe,Je,He,je,Ye,Xe,We,Qe,Ke,Ze,$e,no,eo,oo,to,co,io,ao,ro,lo,uo,so,fo;l=hn||{},s="PLAYER : ",r="",d=1,e=!(ae=!(a=["buffering","idle","advertising","paused","playing","complete","error","ad-buffering","ad-outstream"])),p=f=null,lo="history"in window&&"pushState"in history,m={r:document.getElementById("player").getElementsByTagName("video")[0],$n:null,ne:document.getElementById("player").getElementsByTagName("video")[0].getElementsByTagName("source")[0].getAttribute("src"),Gn:function(){return document.isFullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msIsFullScreen}},jo=null,Ho=function(){l.ee=JSON.parse(JSON.stringify(conf.playlist.videos)),conf.playlist.videos[0]&&(conf.playlist.videos[0]={vid:conf.playlist.videos[0].vid,url:conf.playlist.videos[0].url})},ge=function(){l.ee?l.ee.push.apply(l.ee,conf.playlist.videos):l.oe()},v=function(n){for(var e=0,o=a.length;e<o;e++)n==a[e]?(bn.n(s+"Change state to "+a[e]),bn.g(document.body,"player-state-"+a[e]),r=a[e]):bn.b(document.body,"player-state-"+a[e])},le=function(){return r},me=function(n){m.r.muted=n,m.r.volume=n?0:1,N.Fn()&&N.Fn().setVolume(n?0:1),1==n?bn.g(document.body,"player-is-muted"):bn.b(document.body,"player-is-muted"),conf.template.mute=n},y=function(n,e){if("hls"===n.sources[0].type&&conf.user.device.os&&conf.user.device.os.name&&"ios"!==conf.user.device.os.name.toLowerCase()&&!window.Hls)bn.C(document.body,conf.admin.hls_url,function(){y(n,e)});else{if("hls"===n.sources[0].type&&(0==e?(n.sources[0].original_file=n.sources[0].file,n.sources[0].file+=(n.sources[0].file.indexOf("?")<0?"?":"&")+"pw="+l.l.r.offsetWidth+"&ph="+l.l.r.offsetHeight+"&spw="+_()+"&sph="+h()):n.sources[0].original_file&&(n.sources[0].file=n.sources[0].original_file)),"hls"===n.sources[0].type&&window.Hls&&Hls.isSupported()){var o={startPosition:n.starttime||-1,maxBufferLength:conf.admin.hls_max_buffer,maxMaxBufferLength:conf.admin.hls_max_buffer,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0};(f=new Hls(o)).on(Hls.Events.MANIFEST_PARSED,function(){bn.n("HLS : manifest parsed"),l.ce.te(),m.r.play()}),f.on(Hls.Events.ERROR,function(n,e){if(bn.n("HLS : "+e.type+" "+e.details+" fatal="+e.fatal),e.fatal)switch(e.type){case window.Hls.ErrorTypes.NETWORK_ERROR:bn.n("HLS : fatal network error encountered, try to recover"),f.startLoad();break;case window.Hls.ErrorTypes.MEDIA_ERROR:bn.n("HLS : fatal media error encountered, try to recover"),f.recoverMediaError();break;default:f.destroy()}}),f.on(Hls.Events.DESTROYING,function(){n.sources.shift(),n.sources.length?(bn.n("HLS : fallback to next source ("+n.sources[0].type+")"),y(n,e)):b("No source available")}),f.loadSource(n.sources[0].file),f.attachMedia(m.r)}else{if(!(l.l.r.canPlayType("application/vnd.apple.mpegURL").replace(/^no$/,"")||l.l.r.canPlayType("application/x-mpegURL").replace(/^no$/,"")))for(;n.sources.length&&"hls"===n.sources[0].type;)n.sources.shift();n.sources.length?(m.r.src=n.sources[0].file,m.r.load(),l.ce.te(),m.r.play()):b("No source available")}l.Bn.ie()||l.Ln.tn(),l.ae.tn()}},Ze=function(n){bn.n(s+"resume"),_n.o("contentStart");n=l.t(n);y(n,k),l.le.re()?l.le.zn():l.le.tn(),conf.template.controls.autoskip.button_timeout&&(l.ue=!0),_n.X()},g=function(){document.getElementById("share-bar")&&l.fe.se();var n=l.t(conf.admin.current_index);bn.R(document.getElementById("vsly-overlay"),"click",g),bn.N(l.l.r,n.starttime||.1),m.r.play()},Te=function(n,e){var o=l.t(n),t=o.vid;if(bn.n(s+"reset "+t),l.ce.de(),f&&f.stopLoad(),m.r.src=m.ne,bn.N(m.r,0),l.le.jn(),N.jn(conf.admin.current_index),Cn){if(document.getElementById("share-bar")&&l.fe.se(),conf.admin.reset_article_mapping)for(var c in conf.admin.reset_article_mapping){var i,a=bn.k(c,o);for(i in conf.admin.reset_article_mapping[c])for(var r in conf.admin.reset_article_mapping[c][i])try{document.querySelector(conf.admin.reset_article_mapping[c][i][r])[i]=a}catch(n){continue}}window.referrer,e?history.replaceState({id:n},o.title,o.url+(Ln?"?"+x:"")):history.pushState({id:n},o.title,o.url+(Ln?"?"+x:""))}wn&&l.t(conf.admin.current_index+1)&&(bn.b(document.body,"vsly-show-related"),bn.R(document.getElementById("vsly-related-container"),"click",l.en.pe)),l.ue=!1,N=N.Yn(),l.en=l.en.Yn(),l.Cn.me(),l.Sn.me(),l.Bn.jn(),l.Ln.jn(),d++,w(n)},w=function(n){var e=l.t(n),o=e.vid;bn.n(s+"setup "+o),bn.o(49,n,!0,Xo),conf.admin.current_index=n,document.getElementById("share-bar")&&(document.getElementById("share-bar").innerHTML=e.share_btn),1<d?(document.getElementById("vsly-overlay-image").removeAttribute("srcset"),document.getElementById("vsly-overlay-image").removeAttribute("sizes"),document.getElementById("vsly-overlay-image").setAttribute("src",bn.T(e)),document.getElementById("vsly-overlay-image").setAttribute("alt",e.title)):(Cn&&l.ve&&history.replaceState({id:n},e.title,e.url+(Ln?"?"+x:"")),_n.tn(o)),Cn||(document.getElementById("vsly-overlay-title").textContent=e.title),conf.template.ui&&(document.getElementById("vsly-overlay-title").style.display="none"),l.ye.tn(),document.getElementById("vsly-overlay-button-text").textContent=conf.admin.lng.launch;for(var t=0,c=e.sources.length;t<c;t++)e.sources[t].decoded||(e.sources[t].file=bn.S(bn.x(e.sources[t].file)),e.sources[t].decoded=!0);l.ce.ge(n)},b=function(n){bn.o(45,null,!1),l.ce.de(),l.we(conf.admin.lng.oops,!0)},oo=function(n,e){document.getElementById("vsly-overlay-error").textContent=n;n=document.getElementById("vsly-overlay-error-button");1==e?(n.textContent=conf.admin.lng.relaunch,bn.I(n,"click",function(){parent.window.location.reload()})):n.style.display="none",v("error"),m.r.src=""},Le=function(n){return!0===conf.admin.prefetch_ads&&n&&n!=conf.admin.current_index?d+1:d},Be=function(n){return!0===conf.admin.prefetch_ads&&n&&n!=conf.admin.current_index?conf.admin.current_index+1:conf.admin.current_index},uo=function(n){e=n},$e=function(){return e},_=function(){var n=l.l.r.offsetWidth;return wn&&"panoramic"!==conf.template.sdk.sticky.width&&"none"!==conf.template.sdk.sticky.event&&(560<=parent.document.documentElement.clientWidth?n>conf.sticky.width_large&&(n=conf.sticky.width_large):300<=parent.document.documentElement.clientWidth&&n>conf.sticky.width_short&&(n=conf.sticky.width_short)),n},h=function(){var n=l.l.r.offsetHeight;return n=wn&&"panoramic"!==conf.template.sdk.sticky.width&&"none"!==conf.template.sdk.sticky.event?Number(9*_()/16):n},go=function(){return N},po=function(){return Cn||!0===e&&"none"!==conf.template.sdk.sticky.event&&("optimized"===conf.type||"top"==conf.template.sdk.initial_position)},mo=function(){return Cn||!0===e&&"none"!==conf.template.sdk.sticky.event},Jo=function(n){p=n},n=function(){return null==p&&(conf.template.autoplay?conf.template.mute?l.f()?l.be(T):l.be(D):l.f()?l.be(S):l.be(E):l.be(A)),p},bo=function(){return n()==T||n()==D?C:n()==S||n()==E?O:P},Bo=function(n){return l.ee[n]},Yo=function(n){return l.t(n).vid},l._e=s,l.ue=ae,l.ee=jo,l.oe=Ho,l.he=ge,l.Vn=v,l.$=le,l.Z=me,l.zn=Ze,l.Ie=g,l.jn=Te,l.Re=w,l.ke=y,l.Nn=Le,l.a=Be,l.xe=uo,l.Se=$e,l.we=oo,l.Te=_,l.Ae=h,l.l=m,l.ve=lo,l.Pn=go,l.s=po,l.f=mo,l.be=Jo,l.Dn=n,l.qn=bo,l.An=Yo,l.t=Bo,(I=(hn=l)||{}).en=function s(n){var r="PLAYLIST : ",e=!1,n=n||{},o=conf.playlist.related_url?document.querySelectorAll(".vsly-related-progress"):null,t=!1,c=!0,f=function(){!1===e&&I.ve&&(e=!0,window.addEventListener("popstate",function(n){var e,o;n.state&&void 0!==n.state.id?(e=n.state.id,o=I.An(e),a({id:e,force_request:!0},function(){bn.n(r+"request "+o+" success"),I.jn(e,!0)},function(n){bn.n(r+"request "+o+" "+n),Cn&&(window.location=I.t(e).url+(Ln?"?"+x:""))})):bn.n(r+"no vid")}))},i=function(n){if(Cn){var e,o=I.t(n),t=(bn.n(r+"Replace URL by "+o.vid),history.replaceState({id:n},o.title,o.url+(Ln?"?"+x:"")),JSON.parse(JSON.stringify(conf.admin.reset_article_mapping)));for(e in delete t.title.innerHTML,delete t.user,t){var c,i=bn.k(e,o);for(c in t[e])for(var a in t[e][c])try{document.querySelector(t[e][c][a])[c]=i}catch(n){continue}}}},a=function(n,e,o){var t,c,i=n.id;i?(c=(t=I.t(i)).vid,bn.n(r+"request "+c),t&&t.title&&!n.force_request?(bn.n(r+"We already prefetch vid "+c),e(t)):bn.A(conf.playlist.related_url+c+"?w="+encodeURIComponent(conf.page.url)+"&r="+encodeURIComponent(document.referrer)+"&plix="+(conf.admin.current_index+1)+"&pasi="+conf.page.audience_source.id+"&pasn="+conf.page.audience_source.name,"GET",!0,1e3*conf.admin.request_timeout,function(n){if(n=n&&""!=n?n.trim():n){try{n=JSON.parse(n)}catch(n){return bn.n(r+"Parse JSON error"+n),o("requestFailed")}n.reload?o("requestExpired"):(I.ee[i]=n.video,n.vtr&&(conf.advertising.linear.pred?conf.advertising.linear.pred.vtr=n.vtr:conf.advertising.linear.pred={vtr:n.vtr}),e(n.video))}else o("requestFailed")})):bn.n(r+"no more video")},d=function(e){o&&o.forEach(function(n){n.style.width=e+"%"})},l=function(){bn.n(r+"click");var e=I.An(conf.admin.current_index+1);a({id:conf.admin.current_index+1},function(){I.jn(conf.admin.current_index+1)},function(n){bn.n(r+"request "+e+" "+n),bn.n("next request failed"),Cn&&(window.location=I.t(conf.admin.current_index+1).url+(Ln?"?"+x:""))}),u()},p=function(){I.ue=!1,u()},u=function(){bn.b(document.body,"vsly-show-related"),bn.R(document.getElementById("vsly-related-container"),"click",l)},m=function(o){var e=I.t(o);0==t&&(t=!0,a({id:o},function(n){var e;!0===conf.admin.prefetch_ads&&v(o),conf.playlist.related_url&&n&&(document.querySelector(".vsly-related-next").textContent=conf.admin.lng.related,document.querySelector(".vsly-related-thumbnail img")||(e=document.createElement("img"),document.querySelector(".vsly-related-thumbnail").appendChild(e)),document.querySelector(".vsly-related-thumbnail img").setAttribute("src",bn.T(n)),document.querySelector(".vsly-related-title").textContent=n.title,document.querySelector(".vsly-related-label").textContent=bn.P(parseInt(n.duration),10),bn.I(document.getElementById("vsly-related-stay-btn"),"click",p),bn.I(document.getElementById("vsly-related-next-btn"),"click",l),bn.I(document.getElementById("vsly-related-container"),"click",l))},function(n){bn.n(r+"request "+e.vid+" "+n),Cn&&(window.location=e.url+(Ln?"?"+x:""))}))},v=function(n){bn.n(r+"Prefetch vasts for "+n),i(n),N.Kn(!0),N.Jn(n)},y=function(){var n,e;c&&(n=I.t(conf.admin.current_index+1),e=this.duration-this.currentTime,k||n||1!=conf.playlist.videos.length||I.he(),n?n.title?(e<conf.admin.progress_timeout?(bn.g(document.body,"vsly-show-related"),bn.g(document.body,"vsly-hide-stay")):(bn.b(document.body,"vsly-show-related"),bn.b(document.body,"vsly-hide-stay")),I.ue&&(this.currentTime>conf.template.controls.autoskip.button_timeout+conf.template.controls.autoskip.button_duration?I.ce.Ee():this.currentTime>conf.template.controls.autoskip.button_timeout&&this.currentTime<conf.template.controls.autoskip.button_timeout+conf.template.controls.autoskip.button_duration?bn.g(document.body,"vsly-show-related"):bn.b(document.body,"vsly-show-related"))):(e<=conf.admin.prefetch_timeout||this.currentTime>=(I.ue?conf.template.controls.autoskip.button_timeout-conf.admin.prefetch_timeout:this.duration))&&m(conf.admin.current_index+1):e<=conf.admin.prefetch_timeout&&I.he())},g=function(){return c},w=function(n){0==n&&bn.n(r+"user canceled"),c=n,bn.J(n)};return n.tn=f,n.De=u,n.pe=l,n.En=i,n.Ce=g,n.Oe=y,n.Pe=d,n.nn=w,n.Yn=s,n}(I.en||{}),(ae=(hn=I)||{}).fe=(jo=ae.fe||{},V=!1,U=function(){V=!0,bn.g(document.querySelector(".js-rollBoxToggler"),"is-toggled")},L=function(){V=!1,bn.b(document.querySelector(".js-rollBoxToggler"),"is-toggled")},Ho=function(){var n=this.duration-this.currentTime;!V&&this.currentTime>conf.admin.social_timeout&&n>conf.admin.prefetch_timeout&&U(),V&&(this.currentTime<conf.admin.social_timeout||n<conf.admin.prefetch_timeout)&&L()},(jo=jo||{}).se=L,jo.Oe=Ho,jo)}(M=(hn=ae)||{}).Sn=(ge=M.Sn||{},B=!1,z=bn.j()&&(wn||Cn),G={Ne:null,Ve:null,Ue:!!("android"===(conf.user.device.os&&conf.user.device.os.name&&conf.user.device.os.name.toLowerCase())&&"chrome"===(conf.user.device.browser&&conf.user.device.browser.name&&conf.user.device.browser.name.toLowerCase())&&(conf.user.device.browser&&conf.user.device.browser.version&&conf.user.device.browser.version.major)<53||"ios"===(conf.user.device.os&&conf.user.device.os.name&&conf.user.device.os.name.toLowerCase())||"macosx"===(conf.user.device.os&&conf.user.device.os.name&&conf.user.device.os.name.toLowerCase())&&"ontouchstart"in window),Le:!("android"!==(conf.user.device.os&&conf.user.device.os.name&&conf.user.device.os.name.toLowerCase())||"chrome"!==(conf.user.device.browser&&conf.user.device.browser.name&&conf.user.device.browser.name.toLowerCase())&&"android webview"!=(conf.user.device.browser&&conf.user.device.browser.name&&conf.user.device.browser.name.toLowerCase())||!(56<=(conf.user.device.browser&&conf.user.device.browser.version&&conf.user.device.browser.version.major)))},q=function(e){var n,o=e.type;F(),"touchend"!=e.type&&"touchstart"!=e.type||("viously-touch"==e.target.id?(n=(wn?parent.document:document).elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY),wn?n==window.frameElement&&(o="click"):document.getElementById("vsly-player-container").contains(n)&&(o="click")):document.getElementById("vsly-player-container").contains(e.target)&&(o="click")),bn.n(M._e+"Start playonaction : "+o+" ("+e.type+")"),!1===B&&(N.Jn(conf.admin.current_index),N.Wn(),M.Vn("playing"),void 0!==(n=M.l.r?M.l.r.play():void 0)?(bn.n(M._e+"playonaction promise defined"),n.then(function(n){bn.n(M._e+o+" playonaction promise success"),bn.J(!0),M.l.r.pause(),bn.o(154,null,!0,("click"==o?"&pet=clicktoplay":"&pet=scrolltoplay")+"&ppm="+M.Dn()),B=!0,M.Vn("buffering"),N.Xn()}).catch(function(n){bn.n(M._e+o+" playonaction promise error"),"click"!=e.type&&(z=!1),J()})):(bn.n(M._e+"playonaction promise undefined"),0==M.l.r.paused?(bn.J(!0),M.l.r.pause(),bn.o(154,null,!0,("click"==o?"&pet=clicktoplay":"&pet=scrolltoplay")+"&ppm="+M.Dn()),B=!0,M.Vn("buffering"),N.Xn()):("click"!=e.type&&(z=!1),J())))},F=function(){bn.n(M._e+"Stop playonaction"),_n.Q(),bn.R(document.getElementById("vsly-overlay"),"click",q),!0===z&&(G.Ne&&!0===G.Ue&&bn.R(G.Ne,"touchstart",q),G.Ve&&!0===G.Le&&(G.Ve.style.display="none",bn.R(G.Ve,"touchend",q)))},J=function(){var n,e;bn.n(M._e+"Init playonaction"),M.be(A),M.Vn("idle"),bn.I(document.getElementById("vsly-overlay"),"click",q),_n.W(),!0===z&&(n=wn?parent.document:document,!0===G.Ue&&(G.Ne=n.body,bn.I(G.Ne,"touchstart",q)),!0===G.Le&&(n.getElementById("viously-touch")||((e=document.createElement("div")).id="viously-touch",e.style.cssText="top:0;left:0;right:0;bottom:0;z-index:2147483647;position:fixed;touch-action:none;display:none;",n.body.appendChild(e)),G.Ve=n.getElementById("viously-touch"),G.Ve.style.display="block","chrome"===(conf.user.device.browser&&conf.user.device.browser.name&&conf.user.device.browser.name.toLowerCase())&&72<=(conf.user.device.browser&&conf.user.device.browser.version&&conf.user.device.browser.version.major)&&(G.Ve.style.backgroundColor="rgba(255,255,255,0.01)"),bn.I(G.Ve,"touchend",q,{passive:!1})))},le=function(){return B},me=function(){B=!1},ge.tn=J,ge.Mn=q,ge.$=le,ge.me=me,ge),(t=(hn=M)||{}).Cn=(Ze=t.Cn||{},j=H=!1,Y=!!(conf.user.device.browser&&conf.user.device.browser.name&&conf.user.device.browser.version&&"chrome"===conf.user.device.browser.name.toLowerCase()&&53<=conf.user.device.browser.version.major||conf.user.device.os&&conf.user.device.os.name&&"ios"===conf.user.device.os.name.toLowerCase()&&10<=bn.d()),o={Me:!(W=function(){bn.n(t._e+"Browser blocked autoplay muted"),bn.R(t.l.r,"play",X),bn.R(t.l.r,"suspend",W),t.Sn.tn()}),Be:!(X=function(){bn.n(t._e+"Browser didn't block autoplay muted"),bn.R(t.l.r,"play",X),bn.R(t.l.r,"suspend",W),t.f()?t.be(T):t.be(D),bn.o(154,null,!0,"&pet=autoplay_muted&ppm="+t.Dn()),H=!0,t.Vn("buffering"),N.Jn(conf.admin.current_index)}),ze:function(){o.Me=!0,1<Qo?o.Mn():(bn.I(parent.document.body,"keydown",o.Mn),bn.I(parent.document.body,"mouseover",o.Mn),bn.I(parent.document.body,"touchmove",o.Mn),bn.I(parent.document.body,"touchstart",o.Mn),bn.I(parent.window,"scroll",o.Mn),bn.I(document.body,"keydown",o.Mn),bn.I(document.body,"mouseover",o.Mn),bn.I(document.body,"touchmove",o.Mn),bn.I(document.body,"touchstart",o.Mn),t.Vn("idle"))},Ge:function(){bn.R(parent.document.body,"keydown",o.Mn),bn.R(parent.document.body,"mouseover",o.Mn),bn.R(parent.document.body,"touchmove",o.Mn),bn.R(parent.document.body,"touchstart",o.Mn),bn.R(parent.window,"scroll",o.Mn),bn.R(document.body,"keydown",o.Mn),bn.R(document.body,"mouseover",o.Mn),bn.R(document.body,"touchmove",o.Mn),bn.R(document.body,"touchstart",o.Mn)},Mn:function(){o.Be=!0,o.Ge(),Q(conf.admin.current_index)}},Q=function(e){var n;bn.j()?(bn.n(t._e+"Init autoplay"),0==conf.admin.current_index?conf.template.mute&&Y?!1===o.Me&&!1===o.Be&&bn.H()?(bn.n(t._e+"Waiting for user gesture"),o.ze()):conf.user.device.os&&conf.user.device.os.name&&"ios"===conf.user.device.os.name.toLowerCase()?(t.l.r.src=t.l.ne,t.l.r.play(),bn.I(t.l.r,"play",X),bn.I(t.l.r,"suspend",W)):(t.f()?t.be(T):t.be(D),bn.o(154,null,!0,"&pet=autoplay_muted&ppm="+t.Dn()),H=!0,t.Vn("buffering"),N.Jn(e)):(t.Vn("playing"),void 0!==(n=t.l.r?t.l.r.play():void 0)?(bn.n(t._e+"autoplay promise defined"),n.then(function(n){bn.n(t._e+"autoplay promise success"),t.l.r.pause(),conf.template.mute?t.f()?t.be(T):t.be(D):t.f()?t.be(S):t.be(E),bn.o(154,null,!0,"&pet="+(conf.template.mute?"autoplay_muted":"autoplay_audible")+"&ppm="+t.Dn()),H=!0,t.Vn("buffering"),N.Jn(e)}).catch(function(n){bn.n(t._e+"autoplay promise error"),t.l.r.pause(),t.Sn.tn()})):(bn.n(t._e+"autoplay promise undefined"),0==t.l.r.paused?(t.l.r.pause(),conf.template.mute?t.f()?t.be(T):t.be(D):t.f()?t.be(S):t.be(E),bn.o(154,null,!0,"&pet="+(conf.template.mute?"autoplay_muted":"autoplay_audible")+"&ppm="+t.Dn()),H=!0,t.Vn("buffering"),N.Jn(e)):(t.l.r.pause(),t.Sn.tn()))):(conf.template.mute&&Y||t.l.r.pause(),conf.template.mute?t.f()?t.be(T):t.be(D):t.f()?t.be(S):t.be(E),bn.o(154,null,!0,"&pet="+(conf.template.mute?"autoplay_muted":"autoplay_audible")+"&ppm="+t.Dn()),H=!0,t.Vn("buffering"),N.Jn(e))):(bn.n(t._e+"No autoplay"),t.Sn.tn())},Te=function(n){var e=wn?parent:window,o=wn?_n.Y.getElementsByTagName("iframe")[0]:document.body;(wn||On)&&0==conf.admin.current_index?(0!=conf.page.tcf.googleAllowed&&N.Hn(),wn&&bn.j()&&bn.B(o,e,.01)&&N.Jn(n),conf.template.mute&&Y&&document.body.classList.contains("player-is-sticked")?(bn.n(t._e+"muted and sticked"),Q(n)):(e=wn?parent:window,o=wn?window.frameElement:document.body,wn&&bn.B(o,e,.5)?(bn.n(t._e+"already in viewport"),Q(n)):"onadstart"===conf.template.sdk.sticky.event||"duringads"===conf.template.sdk.sticky.event?(bn.n(t._e+"not in viewport but start anyway"),Q(n)):(bn.n(t._e+"not in viewport"),setInterval(K,100)))):Q(n)},K=function(){var n,e,o;!1===H&&(n=wn?parent:window,e=wn?window.frameElement:document.body,o=Dn?1.5:1.3,bn.B(e,n,.5)?(bn.n(t._e+"in viewport after interval"),Q(conf.admin.current_index),clearInterval(K)):!1===j&&bn.j()&&window.frameElement.getBoundingClientRect().top-parent.document.documentElement.clientHeight*o<0&&(j=!0,bn.n(t._e+"is near the bottom of the viewport"),N.Jn(conf.admin.current_index)))},Le=function(){return H},Be=function(){H=!1},Ze.tn=Te,Ze.$=Le,Ze.me=Be,Ze),(Z=(hn=t)||{}).le=(uo=Z.le||{},u=Z.l.r,nn=document.querySelector("#vsly-player-container"),en=document.getElementById("vsly-play-pause"),on=document.getElementById("vsly-mute"),tn=document.getElementById("vsly-fullscreen"),cn=document.getElementById("vsly-logo"),an=document.querySelector(".js-openReport"),rn=document.getElementById("vsly-seekbar-thumb"),ln=document.getElementById("vsly-seekbar-progress"),un=document.getElementById("vsly-seekbar"),sn=document.getElementById("vsly-volumebar-thumb"),fn=document.getElementById("vsly-volumebar-progress"),dn=document.getElementById("vsly-volumebar-track"),pn=document.getElementById("vsly-volumebar"),mn=document.getElementById("vsly-timer"),vn=document.getElementById("vsly-timer-current"),yn=!1,gn=k,Bn="show-controls",zn=-1<window.location.search.indexOf("layout=mobile"),$e=function(){bn.n(Z._e+"Init controlBar"),en&&Gn(),un&&Yn(),pn&&Xn(),an&&Wn(),cn&&Qn(),tn&&bn.I(u,"loadedmetadata",qn),bn.g(nn,"controls-state-active"),bn.g(document.body,Dn&&!zn?"controls-mobile":"controls-desktop"),Zn(),yn=!0},Gn=function(){conf.template.controls.control_bar.button_play?bn.I(en,"click",function(){u.paused?u.play():u.pause()}):(en.parentNode.removeChild(en),en=null)},qn=function(){var n;conf.template.controls.control_bar.button_fullscreen?(bn.R(u,"loadedmetadata",qn),Fn(),n=function(){var n;(Fn()?jn:Hn)(),0==gn&&(n=Z.l.r.currentTime,Z.ce.de(),Z.ke(Z.t(conf.admin.current_index),!0),bn.N(Z.l.r,n),gn=!0)},document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled?(bn.I(document,"fullscreenchange",Jn),bn.I(tn,"click",n)):u.webkitSupportsFullscreen?bn.I(tn,"click",n):tn.style.display="none"):(tn.parentNode.removeChild(tn),tn=null)},Fn=function(){return!(!document.fullscreenElement&&!document.webkitFullscreenElement&&!document.mozFullScreenElement&&!document.msFullscreenElement&&!u.webkitDisplayingFullscreen)},Jn=function(){Fn()?bn.g(nn,"fullscreen"):bn.b(nn,"fullscreen")},Hn=function(){nn.requestFullscreen?nn.requestFullscreen():nn.webkitRequestFullscreen?nn.webkitRequestFullscreen():nn.mozRequestFullScreen?nn.mozRequestFullScreen():nn.msRequestFullscreen?nn.msRequestFullscreen():u.webkitEnterFullscreen&&u.webkitEnterFullscreen()},jn=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():u.webkitExitFullscreen&&u.webkitExitFullscreen()},Yn=function(){var t,c,o,i,a,e,r,n,l;conf.template.controls.seek_bar?(t=0,o=!1,i=function(n,e){var o=(n.offsetX||n.layerX||(n.changedTouches?n.changedTouches[0].clientX:0))/e.offsetWidth;t=o,c=window.requestAnimationFrame(function(){a(parseInt(100*o),10)})},a=function(n){ln.style.width=n+"%",rn.style.left=n+"%",conf.playlist.related_url&&Z.t(conf.admin.current_index+1)&&((n=u.duration-u.currentTime)<conf.admin.progress_timeout?Z.en.Pe(100*((conf.admin.progress_timeout-n)/conf.admin.progress_timeout).toFixed(2)):Z.en.Pe(0),Z.ue&&(conf.template.controls.autoskip.button_timeout&&u.currentTime>=conf.template.controls.autoskip.button_timeout&&u.currentTime<=conf.template.controls.autoskip.button_timeout+conf.template.controls.autoskip.button_duration?Z.en.Pe(100*((u.currentTime-conf.template.controls.autoskip.button_timeout)/conf.template.controls.autoskip.button_duration).toFixed(2)):u.currentTime>conf.template.controls.autoskip.button_timeout+conf.template.controls.autoskip.button_duration&&Z.en.Pe(0))),cancelAnimationFrame(c)},e=function(n,e){o=!0,bn.R(u,"timeupdate",l),e.target!=rn&&i(e,n)},r=function(n,e){o&&e.target!=rn&&i(e,n)},n=function(n,e){o&&(o=!1,u.currentTime=t*u.duration,Z.ue&&(Z.ue=u.currentTime<conf.template.controls.autoskip.button_timeout),bn.I(u,"timeupdate",l))},l=function(){conf.template.controls.control_bar.video_timer&&(u.currentTime&&(vn.textContent="-"+bn.P(parseInt(u.duration-u.currentTime),10)),u.duration&&conf.template.controls.control_bar.video_timer&&(mn.style.opacity="1")),c=window.requestAnimationFrame(function(){a(parseInt(100/u.duration*u.currentTime,10))})},conf.template.controls.control_bar.video_timer||(mn.parentNode.removeChild(mn),vn=mn=null),bn.I(u,"timeupdate",l),bn.I(un,"mousedown",function(n){e(this,n)}),bn.I(un,"mousemove",bn.L(function(n){r(this,n)},50,!0,!0)),bn.I(document.body,"mouseup",n),R&&(bn.I(un,"touchstart",function(n){e(this,n)}),bn.I(un,"touchmove",bn.L(function(n){r(this,n)},50,!0,!0)),bn.I(document.body,"touchend",n))):(un.parentNode.removeChild(un),vn=mn=rn=ln=un=null)},Xn=function(){var n,t,c,i;conf.template.controls.control_bar.button_volume?((n=function(){u.muted||0==u.volume?bn.g(document.body,"player-is-muted"):bn.b(document.body,"player-is-muted")})(),bn.I(u,"volumechange",n),bn.I(on,"click",function(n){n.target==on&&Z.Z(!u.muted),!0===conf.template.mute?bn.o(43,null,!1):bn.o(44,null,!1)}),Dn&&!zn||(i=function(n){sn.style.bottom=100*(1-n)+"px",fn.style.height=100*n+"px",u.volume=n,window.cancelAnimationFrame(t)},bn.I(pn,"mousedown",function(n){var e;c=!0,n.target!=sn&&(e=(n.offsetY||n.layerY||(n.changedTouches?n.changedTouches[0].clientY:0))/this.offsetHeight,t=window.requestAnimationFrame(function(){i(e)}))}),bn.I(document.querySelector(".c-volumeBar"),"mousemove",bn.L(function(n){var e,o;c&&(n.target==pn||n.target==fn||n.target==dn?pn.offsetHeight&&(e=(o=n.offsetY||n.layerY||(n.changedTouches?n.changedTouches[0].clientY:0))/pn.offsetHeight,t=window.requestAnimationFrame(function(){i(e)})):n.target!=sn&&(o=n.offsetY||n.layerY||(n.changedTouches?n.changedTouches[0].clientY:0),t=100<=o?window.requestAnimationFrame(function(){i(1)}):window.requestAnimationFrame(function(){i(0)})))},50,!0,!0)),bn.I(pn,"mouseup",function(n){c=c&&!1}))):(on.parentNode.removeChild(on),dn=fn=sn=pn=on=null)},Wn=function(){conf.template.controls.control_bar.button_report?bn.I(an,bn.e,Z.Fe.qe):(an.parentNode.removeChild(an),an=null)},Qn=function(){conf.template.controls.control_bar.logo||(cn.parentNode.removeChild(cn),cn=null)},Kn=function(){bn.g(document.body,Bn),clearTimeout($),$=setTimeout(function(){bn.b(document.body,Bn)},conf.admin.display_time_on_touch)},Zn=function(){R&&bn.I(nn,"touchend",Kn),conf.template.controls.control_bar.video_timer&&mn&&(mn.style.opacity="0")},oo=function(){gn=!1,R&&bn.R(nn,"touchend",Kn),Fn()&&jn()},lo=function(){return yn},uo.tn=$e,uo.jn=oo,uo.zn=Zn,uo.re=lo,uo),($n=(hn=Z)||{}).ye=(go=$n.ye||{},ne="UI : ",ee={element:null,brand:{element:null,img:null},title:{element:null}},po=function(){conf.template.ui&&conf.template.ui.header&&(bn.n(ne+"Player has UI"),bn.g(document.body,"has-ui"),ee.element=document.querySelector("#viously-ui"),ee.brand.element=document.querySelector("#viously-ui-header-brand"),ee.brand.img=document.querySelector("#viously-ui-header-brand-img"),ee.title.element=document.querySelector("#viously-ui-video-title"),conf.template.ui.header&&(ee.brand.element.style.background=conf.template.ui.header.brand.background,ee.title.element.style.backgroundColor=conf.template.ui.header.title.background,ee.title.element.style.color=conf.template.ui.header.title.color,ee.title.element.textContent=conf.template.ui.header.title.textContent||$n.t(conf.admin.current_index).title,ee.brand.img.src=conf.template.ui.header.brand.img))},mo=function(){return ee},go.tn=po,go.Je=mo,go),(oe=(hn=$n)||{}).Fe=(Jo=oe.Fe||{},te=!1,ce=function(){bn.n(oe._e+"init report"),te=!0;var n=document.createElement("iframe");n.src=conf.admin.report_url+"?u="+encodeURIComponent(oe.t(conf.admin.current_index).url),n.id="iframe-report",oe.He.vn.appendChild(n)},bo=function(){bn.n(oe._e+"show report"),te||ce(),oe.He.qe(),bn.g(document.body,"show-report")},Jo.qe=bo,Jo),(ie=(hn=oe)||{}).He=(Yo=ie.He||{},Bo=document.getElementById("modal"),Ho=function(){ie.l.r.pause(),bn.g(document.body,"show-modal")},jo=function(){1==ie.l.r.paused&&ie.l.r.play(),bn.b(document.body,"show-modal"),bn.b(document.body,"show-report")},bn.I(document.querySelector(".button-close"),"click",jo),Yo.qe=Ho,Yo.se=jo,Yo.vn=Bo,Yo),(c=(hn=ie)||{}).ce=(ae=c.ce||{},re=!1,le=function(n){var e=c.t(n);bn.n(c._e+"Ready "+e.vid),0==conf.admin.current_index?(c.Z(conf.template.mute),k?c.Cn.tn(n):(e.vasts&&e.vasts.length&&bn.C(document.body,conf.admin.prebid_url,function(){Vn=!0}),c.je.tn(n))):c.Cn.tn(n),_n.o("playerReady")},ue=function(){bn.n(c._e+"play"),c.Vn("playing")},se=function(){bn.n(c._e+"pause"),c.Vn("paused")},fe=function(){var n=c.t(conf.admin.current_index),e="&ec="+this.error.code+"&em="+encodeURIComponent(this.error.message||"nomessage");bn.n(c._e+"error : "+e),1<n.sources.length?(n.sources.shift(),setTimeout(function(){c.zn(conf.admin.current_index)},100)):(bn.o(45,null,!1),ve(),c.we(conf.admin.lng.oops,!0))},de=function(n){bn.n(c._e+"ended"),_n.o("contentComplete");var e=c.t(conf.admin.current_index+1);c.en.De(),bn.o(42,null,!0),e&&e.title&&c.en.Ce()?Cn&&c.ve||!Cn?c.jn(conf.admin.current_index+1):window.location=e.url:(c.Vn("complete"),bn.I(document.getElementById("vsly-overlay"),"click",c.Ie))},pe=function(n){var e,o;this.currentTime&&0<this.currentTime&&this.duration&&0<this.duration&&(e=this.currentTime/this.duration*100,o=c.t(conf.admin.current_index),this.currentTime<o.starttime&&bn.N(c.l.r,o.starttime),o.endtime!=o.duration&&this.currentTime>o.endtime&&bn.N(c.l.r,c.l.r.duration),.1<e&&bn.o(32,null,!0),10<e&&bn.o(33,null,!0),20<e&&bn.o(34,null,!0),30<e&&bn.o(35,null,!0),40<e&&bn.o(36,null,!0),50<e&&bn.o(37,null,!0),60<e&&bn.o(38,null,!0),70<e&&bn.o(39,null,!0),75<e&&(c.Bn.Ye(!1),c.Ln.Ye()),80<e&&bn.o(40,null,!0),90<e&&bn.o(41,null,!0),o.share_btn&&c.fe.Oe.call(this),conf.playlist.related_url&&c.en.Oe.call(this))},me=function(){!1===re&&(bn.n(c._e+"Add player events"),re=!0,bn.I(c.l.r,"play",ue),bn.I(c.l.r,"pause",se),bn.I(c.l.r,"ended",de),bn.I(c.l.r,"timeupdate",pe),bn.I(c.l.r,"error",fe))},ve=function(){!0===re&&(bn.n(c._e+"Remove player events"),re=!1,bn.R(c.l.r,"play",ue),bn.R(c.l.r,"pause",se),bn.R(c.l.r,"ended",de),bn.R(c.l.r,"timeupdate",pe),bn.R(c.l.r,"error",fe))},ae.te=me,ae.de=ve,ae.ge=le,ae.Ee=de,ae),(ye=(hn=c)||{}).Bn=(ge=ye.Bn||{},he=_e=be=!(we="COMPANION : "),Ie=null,Re=document.getElementById("vsly-display-container"),ke=document.getElementById("vsly-display-content"),xe=document.getElementById("vsly-player-container"),Se=document.getElementById("vsly-display-close"),Te=function(n){if(!conf.advertising.companion.allowed)return bn.n(we+"Companions are not enabled for this context."),!1;if(ye.Pn().Qn().vast_index&&-1===["3","31","46"].indexOf(n.id_vast_type))return bn.n(we+"not the right vast type, no companion displayed"),!1;Ae();var e=Ee();return e?(1==he&&(Ce(),Oe()),De(n,e),!0):(bn.n(we+"no ad found"),!1)},Ae=function(){0==be&&(bn.n(we+"initialize"),be=!0,Ue())},Ee=function(){var n=ye.Te(),e=ye.Ae(),o=ye.Pn().Qn().list;if(bn.n(we+"Player size = ["+n+","+e+"]"),!o)return!1;if(o.length)for(var t=o.length;t--;)300==o[t].getWidth()&&50==o[t].getHeight()||(bn.n(we+"["+o[t].getWidth()+"x"+o[t].getHeight()+"] too big"),o.splice(t,1));return!!o.length&&(o.sort(function(n,e){return e.getWidth()*e.getHeight()-n.getWidth()*n.getHeight()}),o[0])},De=function(n,e){var o=Number(ye.Te()),t=e.getWidth(),c=e.getHeight();o<t&&(c=o*e.getHeight()/t,t=o),ke.innerHTML=e.getContent(),t!=e.getWidth()&&((o=ke.getElementsByTagName("img")[0]).setAttribute("width",t),o.setAttribute("height",c)),Ne(Re,t,c),he=!0,Ie=ye.Pn().Qn().vast_index,bn.o(187,null,!1,Pe(n)+"&cpnct="+e.getContentType()+"&cpnw="+e.getWidth()+"&cpnh="+e.getHeight())},Ce=function(n){var e;1==be&&0==_e&&1==he&&(bn.n(we+"clear banner"),e=(e=ye.t(conf.admin.current_index)).vasts[bn.V(e.vasts,"vast_index",Ie)],Ve(),he=!(_e=!0),Ie=null,bn.o(188,null,!1,Pe(e)+"&coc="+!!n))},Oe=function(){bn.n(we+"reset"),he=_e=!1,Ie=null},Pe=function(n){return"&ais="+n.id_ssp+"&ans="+n.ssp_name+"&aivt="+n.id_vast_type+"&anvt="+n.name+"&avt=viously&aaf=nonlinear"},Ne=function(n,e,o){bn.n(we+"set size to ["+e+","+o+"]");var t,c,i,a,r=ye.l.r.offsetWidth;xe.style.height="100%",Re.style.width="100%",Re.style.backgroundColor="#333333",ke.style.margin="0 auto",ke.setAttribute("width",e),ke.style.width=e+"px",ke.style.maxWidth=e+"px",ke.setAttribute("height",o),ke.style.height=o+"px",ke.style.maxHeight=o+"px",wn&&(t=0,conf.template.ui&&conf.template.ui.header&&((e=ye.ye.Je()).element&&(t=e.element.offsetHeight)),window.frameElement.parentNode.setAttribute("style","height:"+(9*r/16+o+t)+"px!important"),_n.Y.setAttribute("style","height:"+(9*_n.Y.offsetWidth/16+o+t)+"px!important"),xe.style.height="calc(100% - "+o+"px)",xe.style.position="relative",window.onresize=bn.L(function(){window.frameElement.parentNode.setAttribute("style","height:"+(9*ye.l.r.offsetWidth/16+o+t)+"px!important"),_n.Y.setAttribute("style","height:"+(9*_n.Y.offsetWidth/16+o+t)+"px!important")},50,!0,!0)),Cn&&(c=document.getElementsByClassName("embed-player")[0],i=document.getElementsByClassName("main")[0],a=document.getElementsByClassName("c-player__info")[0],window.matchMedia("(max-width: 800px)").matches&&window.matchMedia("(orientation: portrait)").matches?(c.setAttribute("style","height: calc(56.25vmin + "+o+"px)"),i.style.height="",a.style.paddingTop="calc(56.25vmin + "+o+"px)"):(c.style.height="",i.setAttribute("style","height:calc(100% + "+o+"px)!important"),a.style.paddingTop=""),xe.style.height="calc(100% - "+o+"px)",xe.style.position="relative",window.onresize=bn.L(function(){window.matchMedia("(max-width: 800px)").matches&&window.matchMedia("(orientation: portrait)").matches?(c.setAttribute("style","height: calc(56.25vmin + "+o+"px)"),i.style.height="",a.style.paddingTop="calc(56.25vmin + "+o+"px)"):(c.style.height="",i.setAttribute("style","height:calc(100% + "+o+"px)!important"),a.style.paddingTop=""),ye.Pn().Zn()},50,!0,!0)),Se.style.display="block"},Ve=function(){var n,e,o;bn.n(we+"Unset banner"),xe.style.height="",Re.style.width="",Re.style.backgroundColor="",ke.style.margin="",ke.setAttribute("width",""),ke.style.width="",ke.style.maxWidth="",ke.setAttribute("height",""),ke.style.height="",ke.style.maxHeight="",wn&&(window.frameElement.parentNode.style.height="",_n.Y.style.height="",xe.style.position=""),Cn&&(n=document.getElementsByClassName("embed-player")[0],e=document.getElementsByClassName("main")[0],o=document.getElementsByClassName("c-player__info")[0],n.style.height="",e.style.height="",o.style.paddingTop="",xe.style.position=""),Se.style.display="",window.onresize=null},Ue=function(){R?Se.ontouchstart=function(){Ce(!0)}:Se.onclick=function(){Ce(!0)}},Le=function(){return he},ge.Mn=Te,ge.Ye=Ce,ge.jn=Oe,ge.ie=Le,ge),(Me=(hn=ye)||{}).Ln=(Be=Me.Ln||{},He=Je=Fe=qe=Ge=ze=!(i="GPT : "),je=null,Ye=[[88,31],[120,20],[120,30],[120,60],[120,90],[120,240],[120,600],[125,125],[160,600],[168,28],[168,42],[180,150],[200,200],[200,446],[216,36],[216,54],[220,90],[234,60],[240,133],[240,400],[250,250],[250,360],[292,30],[300,31],[300,50],[300,75],[300,100],[300,250],[300,600],[300,1050],[320,50],[320,100],[320,480],[336,280],[400,300],[468,60],[480,320],[580,400],[640,480],[728,90],[750,100],[750,200],[750,300],[768,1024],[930,180],[950,90],[960,90],[970,66],[970,90],[970,250],[980,90],[980,120],[1024,768]],Xe="vsly-banner",document.getElementById(Xe),We=document.getElementById("vsly-close-banner"),Qe=document.getElementById("vsly-banner-container"),Ke="vsly-dar-container",Ze=function(){bn.n(i+"init");var n="optimized"===conf.type?conf.advertising.nonlinear.dfp:conf.advertising.nonlinear.dfp_edito;if(n)if("always"===conf.template.advertising.nonlinear.event||"noPreroll"===conf.template.advertising.nonlinear.event&&!1===Je)if(!1===so())1==conf.page.tcf.googleAllowed?(bn.n(i+"not loaded"),bn.C(document.body,"https://securepubads.g.doubleclick.net/tag/js/gpt.js",function(){fo(!0),Me.Ln.tn(),document.getElementById("vsly-close-banner-cross").textContent="Ã"})):bn.n(i+"not allowed");else if(0==Ge)if(window.googletag=window.googletag||{cmd:[]},document.getElementById("vsly-close-banner-cross").textContent="Ã",window.googletag){bn.n(i+"loaded"),Fe=Ge=!0;for(var e=Me.Te(),o=Me.Ae(),t=(bn.n(i+"Player size = ["+e+","+o+"]"),Ye.length);t--;)Ye[t][0]>Number(e-4)||Ye[t][1]>Number(o-4)?(bn.n(i+"["+Ye[t]+"] does not fit the player"),Ye.splice(t,1)):Ye[t][0]>Number(e-30-4)&&Ye[t][1]>Number(o-30-4)?(bn.n(i+"["+Ye[t]+"] does not have space for the cross"),Ye.splice(t,1)):"coalitionForBetterAds"===conf.template.advertising.nonlinear.size&&(.21<=Number(Ye[t][0]*Ye[t][1]/(e*o))?(bn.n(i+"["+Ye[t]+"] not allowed more than 20% of the video player"),Ye.splice(t,1)):.33<=Number(Ye[t][1]/o)&&(bn.n(i+"["+Ye[t]+"] not allowed in the middle third of the video player"),Ye.splice(t,1)));co(Qe,e-4,o-30-4),Qe.className="vsly-banner-position-"+conf.template.advertising.nonlinear.position,ao(n),googletag.cmd.push(function(){bn.n(i+"defineSlot banner"),0==conf.page.tcf.purposeOneAllowed&&googletag.pubads().setPrivacySettings({limitedAds:!0}),Cn&&googletag.pubads().setForceSafeFrame(!0),je=googletag.defineSlot(n.url,Ye,Xe).addService(googletag.pubads()).setCollapseEmptyDiv(!0),Cn||googletag.pubads().enableSingleRequest(),googletag.enableServices()}),googletag.cmd.push(function(){googletag.display(Xe)})}else bn.n(i+"not found");else 0<conf.admin.current_index&&no(n);else bn.n(i+"not granted");else bn.n(i+"not defined")},$e=function(){if(bn.n(i+"init DAR"),!conf.advertising.dar.allowed)return bn.n(i+"no DAR pixel"),!1;1==conf.page.tcf.googleAllowed?!1===so()?bn.C(document.body,"https://securepubads.g.doubleclick.net/tag/js/gpt.js",function(){fo(!0),Me.Ln.Xe()}):0==He&&(window.googletag=window.googletag||{cmd:[]},window.googletag?(bn.n(i+"loaded"),He=!0,ro(),googletag.cmd.push(function(){bn.n(i+"defineSlot banner for DAR"),Cn&&googletag.pubads().setForceSafeFrame(!0),googletag.defineSlot(conf.advertising.dar.ad_unit,[[1,1]],Ke).addService(googletag.pubads()).setCollapseEmptyDiv(!0),Cn||googletag.pubads().enableSingleRequest(),googletag.enableServices()}),googletag.cmd.push(function(){googletag.display(Ke)})):bn.n(i+"not found")):bn.n(i+"not allowed")},no=function(n){1==Ge&&0==Fe&&(Fe=!0,googletag.cmd.push(function(){bn.n(i+"refresh banner"),googletag.pubads().refresh(null,{changeCorrelator:!0}),bn.o(173,null,!1,to(n))}))},eo=function(){1==Ge&&0==qe&&(qe=!0,We.style.display="none",bn.b(document.body,"vsly-show-banner"),document.getElementById("vsly-close-banner").className="",googletag.cmd.push(function(){bn.n(i+"clear banner"),googletag.pubads().clear([je]),bn.o(167,null,!1,"&lads="+(0==conf.page.tcf.purposeOneAllowed)+"&avt=viously&aaf=nonlinear")}))},oo=function(){bn.n(i+"reset"),Je=Fe=qe=!1},to=function(n){return"&ais="+n.id_ssp+"&ans="+n.ssp_name+"&aivt="+n.id_vast_type+"&anvt="+n.name+"&lads="+(0==conf.page.tcf.purposeOneAllowed)+"&avt=viously&aaf=nonlinear"},co=function(n,e,o){bn.n(i+"set max size to ["+e+","+o+"]"),n.style.maxWidth=e+"px",n.style.maxHeight=o+"px"},io=function(n,e,o){bn.n(i+"set size to ["+e+","+o+"]"),n.style.left="50%",n.style.marginLeft=-e/2+"px",n.setAttribute("width",e),n.style.width=e+"px",n.style.maxWidth=e+"px",n.setAttribute("height",o),n.style.height=o+"px",n.style.maxHeight=o+"px",o>Number(Me.Ae()-30-4)&&(document.getElementById("vsly-close-banner").className="vsly-close-banner-right",0<(o=34-(Me.Te()-(e+4))/2)&&(n.style.marginLeft=-(e/2+o)+"px"))},ao=function(e){R?We.ontouchstart=eo:We.onclick=eo,googletag.cmd.push(function(){googletag.pubads().addEventListener("slotOnload",function(n){bn.n(i+"slotOnload "+n.slot.getSlotElementId()),n.slot.getSlotElementId()==Xe&&bn.o(162,null,!1,to(e))}),googletag.pubads().addEventListener("impressionViewable",function(n){bn.n(i+"impressionViewable "+n.slot.getSlotElementId()),n.slot.getSlotElementId()==Xe&&bn.o(164,null,!1,to(e))}),googletag.pubads().addEventListener("slotRequested",function(n){bn.n(i+"slotRequested "+n.slot.getSlotElementId()),n.slot.getSlotElementId()==Xe&&bn.o(159,null,!1,to(e))}),googletag.pubads().addEventListener("slotResponseReceived",function(n){bn.n(i+"slotResponseReceived "+n.slot.getSlotElementId()),n.slot.getSlotElementId()==Xe&&bn.o(160,null,!1,to(e))}),googletag.pubads().addEventListener("slotRenderEnded",function(n){bn.n(i+"slotRenderEnded "+n.slot.getSlotElementId()+" isEmpty="+n.isEmpty),n.slot.getSlotElementId()==Xe&&(bn.o(172,null,!1,to(e)+"&aai="+n.advertiserId+"&acni="+n.campaignId+"&acai="+n.creativeId+"&alii="+n.lineItemId+"&asz="+n.size),0==n.isEmpty&&(We.style.display="block",bn.g(document.body,"vsly-show-banner"),n.size&&1<n.size.length&&io(Qe,n.size[0],n.size[1])))})})},ro=function(){googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRequested",function(n){n.slot.getSlotElementId()==Ke&&bn.n(i+"DAR slotRequested "+n.slot.getSlotElementId())}),googletag.pubads().addEventListener("slotResponseReceived",function(n){n.slot.getSlotElementId()==Ke&&bn.n(i+"DAR slotResponseReceived "+n.slot.getSlotElementId())})})},lo=function(){return Je},uo=function(n){Je=n},so=function(){return ze},fo=function(n){ze=n},Be.tn=Ze,Be.Ye=eo,Be.jn=oo,Be.We=lo,Be.Un=uo,Be.Qe=so,Be.Ke=fo,Be.Xe=$e,Be),(po=(hn=Me)||{}).ae=(mo=po.ae||{},yo=!(vo="OUTBRAIN : "),go=function(){bn.n(vo+"init");var n=conf.advertising.nonlinear.outbrain;n?0==yo?(yo=!0,Cn&&document.querySelector(".OUTBRAIN")&&bn.o(164,null,!1,"&ais="+n.id_ssp+"&ans="+n.ssp_name+"&aivt="+n.id_vast_type+"&anvt="+n.name+"&avt=viously&aaf=nonlinear"),bn.n(vo+"initialized")):bn.n(vo+"not initialized"):bn.n(vo+"not defined")},mo.tn=go,mo);(wo=(hn=po)||{}).je=(bo=wo.je||{},Io=ho=null,Ro=!(_o="GDPR : "),ko=window.__tcfapi,xo=0,So={},To=function(n){if(conf.page.tcf.gdprApplies?(bn.n(_o+"applies"),bn.o(73,null,!0)):bn.n(_o+"doesn't apply"),ko=window.__tcfapi,window.self!=window.parent)try{ko=parent.__tcfapi,bn.n(_o+"get parent CMP")}catch(n){bn.n(_o+"get parent CMP failed")}"function"==typeof ko?(void 0===window.__tcfapi&&(bn.n(_o+"storing the tcfapi in the window"),window.__tcfapi=ko),bn.n(_o+"CMP TCF2 loaded"),wo.Vn("buffering"),ho=setTimeout(function(){Ao("event_listener_timeout")},1e4),ko("addEventListener",2,Do)):(bn.n(_o+"CMP TCF2 not loaded"),On||Pn?(bn.n(_o+"wait for postMessage"),wo.Vn("buffering"),window.addEventListener("message",Eo),wo.Sn.tn(),On&&(window.parent.postMessage({__tcfapiCall:{command:"getTCData",version:2,callId:++xo}},"*"),window.__tcfapi=function(n,e,o,t){window.parent.postMessage({__tcfapiCall:{command:n,parameter:t,version:e,callId:++xo}},"*"),So[xo]=o}),Pn&&window.parent.postMessage({sentinel:"amp",type:"send-intersections"},"*")):!0===conf.page.tcf.gdprApplies&&0<conf.admin.no_tcfapi_retry?setTimeout(function(){conf.admin.no_tcfapi_retry--,To(n)},100):(bn.n(_o+"no tcfapi"),Ao("no_tcfapi")))},Ao=function(n,e){bn.n(_o+n),"function"==typeof ko&&ko("removeEventListener",2,function(){bn.n(_o+"tcfapi removeEventListener")},e=e||1);e=No();e&&1==conf.page.tcf.gdprApplies?Do(e,!0):(bn.o(78,null,!0,"&ptet="+n),!1===conf.page.tcf.gdprApplies&&(conf.page.tcf.googleAllowed=!0,conf.page.tcf.purposeOneAllowed=!0),wo.Cn.tn(conf.admin.current_index))},Eo=function(n){if(n&&n.data&&n.data.__tcfapiReturn&&n.data.__tcfapiReturn.success){bn.n(_o+"getTCData from parent CMP"),window.removeEventListener("message",Eo);var e=n.data.__tcfapiReturn,o=e.returnValue;if("function"==typeof So[e.callId])return So[e.callId](o,e.success),void(So[e.callId]=null);Oo(o),Co(o),bn.o(60,null,!0)}n&&n.data&&"amp"==n.data.sentinel&&"intersection"==n.data.type&&!1===Ro&&n.data.changes.forEach(function(n){.5<=n.intersectionRatio?(bn.n("AMP : Player is in viewport"),!(Ro=!0)===conf.page.tcf.gdprApplies?(conf.page.tcf.googleAllowed=!0,conf.page.tcf.purposeOneAllowed=!0,wo.Cn.tn(conf.admin.current_index)):window.parent.postMessage({sentinel:"amp",type:"send-consent-data"},"*")):bn.n("AMP : Player is not in viewport")}),n&&n.data&&"amp"==n.data.sentinel&&"consent-data"==n.data.type&&(bn.n("AMP : getTCData from amp-consent"),window.removeEventListener("message",Eo),n.data.consentString&&"undefined"!=n.data.consentString?(o=window.parseTCString(n),Oo(o),Co(o)):wo.Cn.tn(conf.admin.current_index),bn.o(60,null,!0))},Do=function(n,e){e&&n.eventStatus&&"undefined"!==n.eventStatus&&(clearTimeout(ho),bn.n(_o+"TCF2 status = "+n.eventStatus),"cmpuishown"===n.eventStatus&&(conf.page.tcf.cmpuistate="shown",wn&&bn.g(_n.Y,"viously-cmp-is-shown"),Io=setTimeout(function(){bn.o(77,null,!0)},3e4)),"tcloaded"!==n.eventStatus&&"tcloadedfromstorage"!==n.eventStatus||(conf.page.tcf.cmpuistate="not_shown"),Oo(n),"useractioncomplete"===n.eventStatus||"tcloaded"===n.eventStatus||"tcloadedfromstorage"===n.eventStatus?(clearTimeout(Io),wn&&bn.b(_n.Y,"viously-cmp-is-shown"),"tcloadedfromstorage"!==n.eventStatus&&n.tcString&&"undefined"!=n.tcString&&Po(n),Co(n),"useractioncomplete"===n.eventStatus&&bn.o(62,null,!0),"tcloaded"===n.eventStatus&&bn.o(60,null,!0),"tcloadedfromstorage"===n.eventStatus&&bn.o(157,null,!0)):"cmpuishown"===n.eventStatus&&bn.o(61,null,!0))},Co=function(n){var e,o;n.tcString&&"undefined"!=n.tcString?("function"==typeof ko&&ko("removeEventListener",2,function(){bn.n("tcfapi removeEventListener")},n.listenerId),n.vendor.consents[755]?conf.page.tcf.googleAllowed=!0:conf.page.tcf.googleAllowed=!1,n.purpose&&n.purpose.consents[1]?conf.page.tcf.purposeOneAllowed=!0:conf.page.tcf.purposeOneAllowed=!1,conf.page.tcf.cmp.id&&(e=Lo(conf.page.tcf.nbVendors),o=Mo(conf.page.tcf.nbAddtlConsent),"full_consent"==e&&"full_consent"==o?bn.o(74,null,!0):"no_consent"==e&&"no_consent"==o?bn.o(76,null,!0):bn.o(75,null,!0)),e=wn?parent:window,o=wn?window.frameElement:document.body,bn.B(o,e,.5)&&"useractioncomplete"===n.eventStatus&&!0===bn.j()?wo.Sn.Mn({type:"delegation"}):wo.Cn.tn(conf.admin.current_index)):Ao("no_tcstring",n.listenerId)},Oo=function(n){n.tcString&&"undefined"!=n.tcString&&(conf.page.tcf.tcString=n.tcString),conf.page.tcf.nbVendors=Vo(n.vendor),conf.page.tcf.consentType=Lo(conf.page.tcf.nbVendors),conf.page.tcf.addtlConsent=n.addtlConsent,conf.page.tcf.nbAddtlConsent=Uo(n.addtlConsent),conf.page.tcf.additionalConsentType=Mo(conf.page.tcf.nbAddtlConsent),"boolean"==typeof n.gdprApplies&&(conf.page.tcf.gdprApplies=n.gdprApplies),conf.page.tcf.purpose=n.purpose,conf.page.tcf.vendor=n.vendor,conf.page.tcf.cmp.id=n.cmpId,conf.page.tcf.cmp.version=n.cmpVersion},Po=function(n){Mn.an("vsly_tcf_storage",JSON.stringify(n))},No=function(){var e=Mn.rn("vsly_tcf_storage");if(e)try{(e=JSON.parse(e)).eventStatus="tcloadedfromstorage"}catch(n){e=!1}return e},Vo=function(n){var e=0;if(n&&n.consents)for(var o in n.consents)1==n.consents[o]&&e++;return e},Uo=function(n){var e=0;return n&&0<n.indexOf("~")?n.split(".").length-1:e},Lo=function(n){return 650<=n?"full_consent":0==n?"no_consent":"partial_consent"},Mo=function(n){return 600<=n?"full_consent":0==n?"no_consent":"partial_consent"},bo.tn=To,bo);var po,mo,vo,yo,go,wo,bo,_o,ho,Io,Ro,ko,xo,So,To,Ao,Eo,Do,Co,Oo,Po,No,Vo,Uo,Lo,Mo,hn=wo;if(window.self!=window.parent)try{parent.viously&&(window.viously=parent.viously)}catch(n){}window.viously||(window.viously={});var Bo,zo,Go,qo,Fo,Jo=Mn.rn("vsl_session"),Ho=new Date,jo=(!(Jo=Jo&&JSON.parse(Jo))||Jo.expiration<Ho.getTime()?Mn.an("vsl_session",JSON.stringify({value:conf.id_session_one_hour,expiration:Ho.getTime()+36e5})):conf.id_session_one_hour=Jo.value,Mn.sn("vsly_session")),Yo=((jo=jo&&JSON.parse(jo))?(conf.page.audience_source.id=jo.audience_source_id,conf.page.audience_source.name=jo.audience_source_name):Mn.un("vsly_session",JSON.stringify({audience_source_id:conf.page.audience_source.id,audience_source_name:conf.page.audience_source.name})),hn.oe(),Cn||"pageload"===conf.template.sdk.sticky.event?bn.o(50,null,!0):(Bo=wn?parent:window,zo=wn?window.frameElement:document.body,wn?bn.B(zo,Bo,.5)?bn.o(50,null,!0):(hn.xe(!1),bn.o(51,null,!0),"IntersectionObserver"in Bo&&(qo=new Bo.IntersectionObserver(function(n){n.forEach(function(n){n.target==zo&&.5<=n.intersectionRatio&&(bn.o(52,null,!0),qo.disconnect())})},{threshold:.5})).observe(zo)):"IntersectionObserver"in Bo?(bn.n("Init IntersectionObserver supported"),Go=!1,(qo=new Bo.IntersectionObserver(function(n){n.forEach(function(n){n.target==zo&&(n.intersectionRatio<.5?(Go=!0,hn.xe(!1),bn.o(51,null,!0)):(!1===Go?bn.o(50,null,!0):bn.o(52,null,!0),qo.disconnect()))})},{threshold:.5})).observe(zo)):bn.B(zo,Bo,.5)?bn.o(50,null,!0):bn.o(51,null,!0)),document.getElementById("viously-critical-css")),Xo=(Yo&&Yo.parentNode.removeChild(Yo),jo||bn.o(0,null,!0),""),Wo=(wn&&(Xo+="&ppos="+(window.frameElement.parentNode.parentNode.getBoundingClientRect().top+window.parent.pageYOffset)),conf.page.grapeshot&&conf.page.grapeshot.gv_safe&&conf.advertising.linear.pred&&conf.advertising.linear.pred.vtr.dur&&70<conf.advertising.linear.pred.vtr.dur[30]&&(Xo+="&ppce=true"),bn.o(158,null,!0,Xo),wn||bn.o(201,null,!0,"&prvs="+(conf.related_videos&&conf.related_videos.status?conf.related_videos.status:"")),function(n){for(var e=0;e<n.length;e++){var o=n[e];bn.n("PLAYER : ReportingObserver"),bn.n(o),o.body&&"HeavyAdIntervention"==o.body.id&&(bn.n("PLAYER : HeavyAdIntervention"),bn.o(63,!1,!0,"&message="+encodeURIComponent(o.body.message)+"&sourceFile="+encodeURIComponent(o.body.sourceFile)+"&lineNumber="+encodeURIComponent(o.body.lineNumber)+"&columnNumber="+encodeURIComponent(o.body.columnNumber)),_n.o("heavyAdIntervention"),wn?parent.viously.fn.destroy(!0):window.location.reload())}}),Qo=(window.ReportingObserver&&(Fo=new ReportingObserver(function(n){Wo(n)},{buffered:!0})).observe(),(wn?window.parent:window).pageYOffset),Ko=wn?setInterval(function(){window.parent.pageYOffset>Qo&&(Qo=window.parent.pageYOffset)},1e3):null;window.onpagehide=function(){wn||bn.o(48,null,!0,"&scrm="+Qo),window.ReportingObserver&&Wo(Fo.takeRecords()),clearInterval(Ko)},!wn&&window.webVitals&&(webVitals.onCLS(function(n){0<=n.value&&bn.o(196,null,!0,"&wvv="+n.value),bn.n("PLAYER : WebVitals : "+n.name+" = "+n.value)}),webVitals.onFCP(function(n){0<=n.value&&bn.o(197,null,!0,"&wvv="+n.value),bn.n("PLAYER : WebVitals : "+n.name+" = "+n.value)}),webVitals.onFID(function(n){0<=n.value&&bn.o(198,null,!0,"&wvv="+n.value),bn.n("PLAYER : WebVitals : "+n.name+" = "+n.value)}),webVitals.onLCP(function(n){0<=n.value&&bn.o(199,null,!0,"&wvv="+n.value),bn.n("PLAYER : WebVitals : "+n.name+" = "+n.value)}),webVitals.onTTFB(function(n){var e=n.value-n.entries[0].requestStart;0<=e&&bn.o(200,null,!0,"&wvv="+e),bn.n("PLAYER : WebVitals : "+n.name+" = "+e)}),webVitals.onINP(function(n){0<=n.value&&bn.o(203,null,!0,"&wvv="+n.value),bn.n("PLAYER : WebVitals : "+n.name+" = "+n.value)})),Cn&&hn.en.tn(),-1<navigator.userAgent.indexOf("Opera Mini")?hn.we(conf.admin.lng.update,!1):hn.Re(conf.admin.current_index),Cn&&"object"==typeof lazyload&&lazyload.init({mobilePictureWidth:321})}();